<link rel="stylesheet" href="../default.css">
<script src="../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            device=wav.device,
            dtype=torch.long,
        )
        factor = <a id="change">int(</a>self.config.num_negatives<a id="change"> // </a>dynamic_num_negatives.item()<a id="change">)</a>
        negative_sample_indices<a id="change"> = </a>torch.cat(
            [negative_sample_indices] * factor, dim=-1
        )
</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47 Fairseq does it only on the masked indices, but this only work if you
        &#47&#47 have long sentences. For more versatily, we sample on the entire sequence.
        &#47&#47 value.
        full_sentence_indices = np.ones((batch_size<a id="change">, sequence_length</a>))

        &#47&#47 print(np.sum(mask_time_indices, axis=1))
        negative_sample_indices = torch.tensor(</code></pre>