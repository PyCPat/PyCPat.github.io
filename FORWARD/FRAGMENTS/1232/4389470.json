{"BEFORE":"        target = target.clone()\n\n        mask = target > 0\n        target[mask] = (target[mask] - target[mask].min()) \/ (target[mask].max() - target[mask].min()) * 9 + 1\n        target[mask] = 10. \/ target[mask]\n        target[~mask] = 0.\n\n        # mask2 = prediction > 0\n        # prediction[mask2] = (prediction[mask2] - prediction[mask2].min()) \/ (prediction[mask2].max() - prediction[mask2].min()) * 9 + 1\n        # prediction[mask2] = 10. \/ prediction[mask2]\n        # prediction[~mask2] = 0.\n\n        if printable:\n            print(\"******************************************************\")\n            print(target.shape, target.mean(), target.max(), target.min())\n            print(prediction.shape, prediction.mean(), prediction.max(), prediction.min())\n","AFTER":"        prediction = prediction.clone()\n        # target = target.clone()\n        print(target.shape, prediction.shape)\n        mask = target > 0\n        target[mask] = (target[mask] - target[mask].min()) \/ (target[mask].max() - target[mask].min()) * 9 + 1\n        #target[mask] = 10. \/ target[mask]\n        target[~mask] = 0.\n\n        mask2 = prediction > 0\n        # print(mask2.type(torch.float32).mean())\n        #prediction[mask2] = (prediction[mask2] - prediction[mask2].min()) \/ (prediction[mask2].max() - prediction[mask2].min()) * 9 + 1\n        #prediction[mask2] = 10. \/ prediction[mask2]\n        prediction[~mask2] = 0.\n\n        if printable:\n            print(\"******************************************************\")\n            print(target.shape, target.mean().item(), target.max().item(), target.min().item())\n            print(prediction.shape, prediction.mean().item(), prediction.max().item(), prediction.min().item())\n"}