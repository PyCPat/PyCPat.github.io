<link rel="stylesheet" href="../default.css">
<script src="../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        ]
        q = rearrange(q, &quotb n (h d) -&gt; b h n d&quot, h=h_q)
        k = rearrange(k, &quotb n (h d) -&gt; b h n d&quot, h=h_kv)
        v<a id="change"> = </a><a id="change">rearrange(</a>v, <a id="change">&quotb n (h d) -&gt; b h n d&quot</a><a id="change">, h=h_kv)</a>

        &#47&#47 _ = [print(i.shape) for i in [q,k,v]]

        dots = einsum(&quotb h i d, b h j d -&gt; b h i j&quot, q, k) * self.scale</code></pre><h3>After Change</h3><pre><code class='java'>

        

        <a id="change">if </a><a id="change">k_tokens is None and v_tokens is None:
            </a>v_tokens = k_tokens<a id="change"> = </a>q_tokens
        elif k_tokens is not None and v_tokens is not None:
            pass
        else:</code></pre>