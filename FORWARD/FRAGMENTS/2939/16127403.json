{"BEFORE":"\t\tx = self.convs(img)\n\t\th = torch.sum(x, dim=[2, 3])\n\n\t\tout = self.linear(h)\n\t\treturn out\n","AFTER":"\tdef forward(self, x, y):\n\t\th = self.shared(x)\n\t\th = h.view(h.size(0), -1)\n\t\tout = []\n\t\tfor layer in self.unshared:\n\t\t\tout += [layer(h)]\n\t\tout = torch.stack(out, dim=1)  # (batch, num_domains, style_dim)\n\t\tidx = torch.LongTensor(range(y.size(0))).to(y.device)\n\t\ts = out[idx, y]  # (batch, style_dim)\n\t\treturn s\n"}