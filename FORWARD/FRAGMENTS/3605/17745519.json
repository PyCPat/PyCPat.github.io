{"BEFORE":"                    x = x.detach().to(self.device).requires_grad_()\n                    self.cache_input[micro_batch_idx] = x\n                    x = self.layers(x)\n                else:\n                    # FIXME: explicitly creating new objects\n                    x = [y.detach().to(self.device).requires_grad_()\n                         for y in x]\n                    self.cache_input[micro_batch_idx] = x\n                    x = self.layers(*x)\n            return x\n        else:\n            with torch.no_grad():\n                if isinstance(x, Tensor):\n                    x = x.to(self.device)\n                    x = self.layers(x)\n                else:\n                    x = [y.to(self.device) for y in x]\n","AFTER":"                    x.detach_().requires_grad_()\n                    self.input_buffer[micro_batch_idx] = x\n                    x = self.layers(x)\n                else:\n                    for tensor in x:\n                        tensor.detach_().requires_grad_()\n                    self.input_buffer[micro_batch_idx] = x\n"}