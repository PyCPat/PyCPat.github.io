{"BEFORE":"        b, c, *_, h, w = x.shape\n\n        is_video = x.ndim == 5\n        convolve_across_time &= is_video\n\n        if is_video:\n            x = rearrange(x, 'b c f h w -> (b f) c h w')\n\n        x = self.spatial_conv(x)\n\n        if is_video:\n            x = rearrange(x, '(b f) c h w -> b c f h w', b = b)\n\n        if not convolve_across_time:\n            return x\n\n        x = rearrange(x, 'b c f h w -> (b h w) c f')\n\n        x = self.temporal_conv(x)\n\n        x = rearrange(x, '(b h w) c f -> b c f h w', h = h, w = w)\n\n        return x\n","AFTER":"        time_emb = None,\n        convolve_across_time = True\n    ):\n\n        scale_shift = None\n        if exists(self.time_mlp) and exists(time_emb):\n            time_emb = self.time_mlp(time_emb)\n            time_emb = rearrange(time_emb, 'b c -> b c 1 1')\n            scale_shift = time_emb.chunk(2, dim = 1)\n\n        h = self.block1(x, scale_shift = scale_shift, convolve_across_time = convolve_across_time)\n\n        h = self.block2(h, convolve_across_time = convolve_across_time)\n\n        return h + self.res_conv(x)\n"}