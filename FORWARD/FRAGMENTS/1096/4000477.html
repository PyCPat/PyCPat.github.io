<link rel="stylesheet" href="../default.css">
<script src="../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        
        assert mode == "train" and tokenized_cap is not None
        batch_size = video.shape[0]
        cap_len = <a id="change">len(</a>tokenized_cap[&quotinput_ids&quot]<a id="change">)</a>

        &#47&#47 Encode the video
        &#47&#47 [N,T,H,W,C] -&gt; [batch_size, channel, temporal_dim, height, width]
        video = rearrange(video, &quotn t h w c -&gt; n c t h w&quot)</code></pre><h3>After Change</h3><pre><code class='java'>
            cls_count = 0
            for i in range(self.max_out_len - 1):
                &#47&#47 generate mask
                cap_padding_mask = <a id="change">(current_word == pad_id).transpose(1</a>, <a id="change">0</a><a id="change">)</a>
                mylogger.debug("cap_padding_mask: {}".format(str(cap_padding_mask.shape)))  &#47&#47 cap_padding_mask: torch.Size([2, 1])

                &#47&#47 embedding current word
                current_word = current_word.to(torch.int)</code></pre>