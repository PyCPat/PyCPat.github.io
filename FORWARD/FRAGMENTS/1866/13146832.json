{"BEFORE":"\t\thidden = enc_h.size(2)\n\t\tdec_state = (dec_h0, dec_c0)\n\t\tdec_i1 = torch.rand(batch, 1, hidden).to(device)#hidden not embed\n\t\tfor i in range(city_t):\n\t\t\tdec_h, dec_state = self.LSTMprocess_block(dec_i1, dec_state)\n\t\t\tdec_i1 = self.attending_mechanism(enc_h, dec_h)\n\t\t'''\t\n\t\t- page 5\/15 in paper\n\t\tcritic model architecture detail is out there, \"Critic\u2019s architecture for TSP\"\n\t\t- page 14\/15 in paper\n\t\tglimpsing more than once with the same parameters \n\t\tmade the model less likely to learn and barely improved the results \n\t\t\n\t\tdec_h(batch,1,hidden)*FC(hidden,hidden)*FC(hidden,1) -> pred_l(batch,1,1) ->pred_l(batch)\n\t\t'''\n\t\tpred_l = self.final2FC(dec_h).squeeze(1).squeeze(1)\n","AFTER":"\t\tdec_input = self.dec_input.unsqueeze(0).repeat(batch,1).unsqueeze(1).to(device)\n\t\tfor i in range(city_t):\n\t\t\t_, (h, c) = self.Decoder(dec_input, (h, c))\n\t\t\tquery, ref = h.squeeze(0), enc_h\n\t\t\tfor i in range(self.n_glimpse):\n\t\t\t\tquery = self.glimpse(query, ref)\n\t\t'''\t\n\t\t- page 5\/15 in paper\n\t\tcritic model architecture detail is out there, \"Critic\u2019s architecture for TSP\"\n\t\t- page 14\/15 in paper\n\t\tglimpsing more than once with the same parameters \n\t\tmade the model less likely to learn and barely improved the results \n\t\t\n\t\tquery(batch,hidden)*FC(hidden,hidden)*FC(hidden,1) -> pred_l(batch,1) ->pred_l(batch)\n\t\t'''\n\t\tpred_l = self.final2FC(query).squeeze(-1)\n"}