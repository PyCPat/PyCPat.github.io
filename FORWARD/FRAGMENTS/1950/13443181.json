{"BEFORE":"        batch_a = torch.cat(\n            [self.transform(item[0]).unsqueeze_(0) for item in batch], 0\n        )\n        batch_b = torch.cat(\n            [self.transform(item[0]).unsqueeze_(0) for item in batch], 0\n        )\n        labels = torch.tensor([item[1] for item in batch]).long()\n        fnames = [item[2] for item in batch]\n        return (torch.cat((batch_a, batch_b), 0),\n                torch.cat((labels, labels), 0),\n                fnames)\n","AFTER":"        batch_size = len(batch)\n\n        # list of transformed images\n        transforms = [self.transform(batch[i % batch_size][0]).unsqueeze_(0)\n                      for i in range(2 * batch_size)]\n        # list of labels\n        labels = [batch[i % batch_size][1] for i in range(2 * batch_size)]\n        # list of filenames\n        fnames = [item[2] for item in batch]\n\n        tuple_of_batches = (\n            torch.cat(transforms, 0),\n            torch.LongTensor(labels),\n            fnames,\n        )\n        return tuple_of_batches\n"}