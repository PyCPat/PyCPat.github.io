{"BEFORE":"        return x\n","AFTER":"    def forward(self, x, mask = None):\n        b, n, device = *x.shape, x.device\n        x = self.token_emb(x)\n\n        pos_emb = self.pos_emb(torch.arange(n, device = device))\n        pos_emb = rearrange(pos_emb, 'n d -> () n d')\n\n        x = x + pos_emb\n        x = rearrange(x, 'b n d -> b d n')\n\n        for attn, ff in self.layers:\n            x = attn(x) + x\n            x = ff(x) + x\n\n        return self.to_logits(x)\n"}