{"BEFORE":"        out = self.layer4(out)\n\n        if isinstance(self.pool, SAP):\n            stats, penalty = self.pool(out)\n        else:\n            stats = self.pool(out)\n\n        embed_a = self.seg_1(stats)\n        out = F.relu(embed_a)\n        out = self.seg_bn_1(out)\n        embed_b = self.seg_2(out)\n        \n        if isinstance(self.pool, SAP):\n            return embed_a, embed_b, penalty\n        else:\n            return embed_a, embed_b\n\n\ndef ResNet18(feat_dim, embed_dim, n_stats=2):\n","AFTER":"        x = x.permute(0, 2, 1) # (B,T,F) => (B,F,T)\n\n        x = x.unsqueeze_(1)\n        out = F.relu(self.bn1(self.conv1(x)))\n        out = self.layer1(out)\n        out = self.layer2(out)\n        out = self.layer3(out)\n        out = self.layer4(out)\n\n        #if isinstance(self.pool, SAP):\n        #    stats, penalty = self.pool(out)\n        #else:\n        stats = self.pool(out)\n\n        embed_a = self.seg_1(stats)\n        out = F.relu(embed_a)\n        out = self.seg_bn_1(out)\n        embed_b = self.seg_2(out)\n        \n        #if isinstance(self.pool, SAP):\n        #    return embed_a, embed_b, penalty\n        #else:\n        return embed_a, embed_b\n"}