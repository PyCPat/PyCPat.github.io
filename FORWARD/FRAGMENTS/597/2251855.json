{"BEFORE":"        src_mask = src_mask.float().unsqueeze(-1) # [batch, seq_len, 1]\n        mel_mask = mel_mask.float().unsqueeze(-1) # [batch, mel_len, 1]\n        attn_mask = torch.bmm(src_mask, mel_mask.transpose(-2, -1)).bool() # [batch, seq_len, mel_len]\n","AFTER":"        src_len, mel_len = src_mask.shape[1], mel_mask.shape[1]\n        src_mask_ = src_mask.unsqueeze(-1).expand(-1, -1, mel_len) # [batch, seq_len, mel_len]\n        mel_mask_ = mel_mask.unsqueeze(1).expand(-1, src_len, -1) # [batch, seq_len, mel_len]\n"}