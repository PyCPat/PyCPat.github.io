{"BEFORE":"        if self.upsampling_filter.size(0) == 1:\n            return x\n\n        d = x.dim()\n        if d == 1:\n            x = x.view(1, -1, 1)\n        elif d == 2:\n            x = x.unsqueeze(0)\n        assert x.dim() == 3, \"Input must be 3D tensor\"\n        B, _, D = x.shape\n\n        x = x.unsqueeze(1)  # (B, 1, N, D)\n        x = self.pad(x)\n\n        y = F.conv2d(x, self.upsampling_filter)  # (B, P, N, D)\n        y = y.permute(0, 2, 1, 3).reshape(B, -1, D)\n","AFTER":"        if self.scale_factor == 1:\n            return x\n\n        d = x.dim()\n        if d == 1:\n            x = x.view(1, -1, 1)\n        elif d == 2:\n            x = x.unsqueeze(0)\n        assert x.dim() == 3, \"Input must be 3D tensor\"\n        B, _, D = x.shape\n\n        x = x.transpose(1, 2)\n        x = self.pad(x)\n        x = F.interpolate(\n            x,\n            (x.size(-1) - 1) * self.scale_factor + 1,\n            mode=\"linear\",\n            align_corners=True,\n        )[..., :-1]\n        y = x.transpose(1, 2).reshape(B, -1, D)\n"}