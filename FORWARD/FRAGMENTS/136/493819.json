{"BEFORE":"        m1 = modalities[0]\n        m2 = modalities[1]\n        return\n","AFTER":"        if len(modalities) == 1:\n            return modalities[0]\n        elif len(modalities) == 2:\n            m1 = modalities[0]\n            m2 = modalities[1]\n            t1 = torch.einsum('bn, nmd -> bmd', m1, self.W)\n            t1 = torch.einsum('bmd, bm -> bd', t1, m2)\n            t2 = torch.einsum('bn, nd -> bd', m1, self.U)\n            t3 = torch.einsum('bm, md -> bd', m2, self.V)\n            return t1 + t2 + t3 + self.b\n        # TODO: extend to more than 2 modalities\n        else:\n            assert False\n\n\n\nclass TensorFusion(nn.Module):\n"}