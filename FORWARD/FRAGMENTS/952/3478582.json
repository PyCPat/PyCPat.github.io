{"BEFORE":"        logit = self.getLogit(q, k)\n        trueCode = logit.argmax(-1)\n        sample = F.gumbel_softmax(logit, temperature, True)\n        target = self._codebook\n        hard = sample @ target\n        hard = hard.permute(0, 3, 1, 2)\n\n        # if self._wvShadow is not None:\n        #     softSample = (logit \/ temperature).softmax(-1)\n        #     soft = softSample @ self._wvShadow(self._codebook)\n        #     soft = soft.permute(0, 3, 1, 2)\n        # else:\n        #     soft = hard\n\n        # [n, c, h, w], [n, h, w], [n, h, w, k], [n, c, h, w], [k, c]\n        return hard, trueCode, logit\n","AFTER":"        logit = self.getLogit(q, k)\n        trueCode = logit.argmax(-1)\n        sample = F.gumbel_softmax(logit, temperature, True)\n        code = sample.argmax(-1)\n        target = self._codebook\n        hard = sample @ target\n        hard = hard.permute(0, 3, 1, 2)\n\n        # if self._wvShadow is not None:\n        #     softSample = (logit \/ temperature).softmax(-1)\n        #     soft = softSample @ self._wvShadow(self._codebook)\n        #     soft = soft.permute(0, 3, 1, 2)\n        # else:\n        #     soft = hard\n\n        # [n, c, h, w], [n, h, w], [n, h, w, k], [n, c, h, w], [k, c]\n        return hard, code, trueCode, logit\n"}