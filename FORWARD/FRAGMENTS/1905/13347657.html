<link rel="stylesheet" href="../default.css">
<script src="../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

        &#47&#47 b(hc)1q -&gt; bqhc
        &#47&#47 print(keys.shape, "keys", values.shape, "values", queries.shape, "queries")
        keys = <a id="change">keys.transpose(1</a>, <a id="change">3</a><a id="change">)</a>
        keys = keys.reshape(keys.shape[:2] + (self.head_count, -1))

        &#47&#47 b(hc)1q -&gt; bchq
        shape = (batch_count, self.head_count, self.head_dim, -1)</code></pre><h3>After Change</h3><pre><code class='java'>
            attention_weights, 
            values
        )
        shape = <a id="change">attention_output.shape[:2]</a> + (self.embed_count,)
        attention_output = attention_output.reshape(shape)
        attention_output = self.out_proj.forward(attention_output)
        return attention_output</code></pre>