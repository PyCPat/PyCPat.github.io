{"BEFORE":"        factors = torch.exp(static_weight * input \/ (1.0 + weight * input))\n        \n        # electron pairs with different spins\n        factors_updown = factors[:,:nup,nup:]\n\n        # electron pairs up up\n        factors_upup = factors_[:,:nup,:nup]\n        factors_upup = factors_upup[:,torch.tril(torch.ones(nup,nup))==0]\n\n        # electron pairs down,down\n        factors_downdown = factors_[:,nup:,nup:]\n        factors_downdown = factors_downdown[:,torch.tril(torch.ones(ndown,ndown))==0]\n\n        return factors_upup.prod(1) * factors_downdown.prod(1) * factors_updown.prod(2).prod(1)\n","AFTER":"        factors = torch.exp(self.static_weight * input \/ (1.0 + self.weight * input))\n        #factors = factors[:,torch.tril(torch.ones(self.nelec,self.nelec))==0].prod(1)\n        factors = factors.sum(2).sum(1)\n        return factors.view(-1,1)\n"}