{"BEFORE":"        device, dtype, n = x.device, x.dtype, x.shape[-1]\n\n        seq = torch.linspace(-1., 1., steps = n, device = device)\n        seq = seq.unsqueeze(-1)\n\n        scales = self.scales[(*((None,) * (len(seq.shape) - 1)), Ellipsis)]\n        scales = scales.to(x)\n\n        seq = seq * scales * pi\n\n        x_sinu = repeat(seq, 'i d -> i j d', j = n)\n        y_sinu = repeat(seq, 'j d -> i j d', i = n)\n","AFTER":"        device, dtype, h, w = x.device, x.dtype, *x.shape[-2:]\n\n        seq_x = torch.linspace(-1., 1., steps = h, device = device)\n        seq_x = seq_x.unsqueeze(-1)\n\n        seq_y = torch.linspace(-1., 1., steps = w, device = device)\n        seq_y = seq_y.unsqueeze(-1)\n\n        scales = self.scales[(*((None,) * (len(seq_x.shape) - 1)), Ellipsis)]\n        scales = scales.to(x)\n\n        scales = self.scales[(*((None,) * (len(seq_y.shape) - 1)), Ellipsis)]\n        scales = scales.to(x)\n\n        seq_x = seq_x * scales * pi\n        seq_y = seq_y * scales * pi\n\n        x_sinu = repeat(seq_x, 'i d -> i j d', j = w)\n        y_sinu = repeat(seq_y, 'j d -> i j d', i = h)\n"}