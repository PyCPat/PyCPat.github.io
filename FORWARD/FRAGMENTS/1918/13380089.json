{"BEFORE":"        return -torch.sum(torch.log(torch.clamp(score, 1e-10, 1.0)) * torch.clamp(label, 0.0, 1.0) + \\\n            torch.log(torch.clamp(1-score, 1e-10, 1.0)) * torch.clamp(-label, 0.0, 1.0))\n","AFTER":"        pos = torch.log(torch.clamp(score, 1e-10, 1.0)) * torch.clamp(label, 0.0, 1.0)\n        neg = torch.log(torch.clamp(1-score, 1e-10, 1.0)) * torch.clamp(-label, 0.0, 1.0)\n        num_pos = torch.sum(torch.clamp(label, 0.0, 1.0), -1)\n        num_neg = torch.sum(torch.clamp(-label, 0.0, 1.0), -1)\n        loss = - torch.sum(torch.sum(pos, -1)\/num_pos) - torch.sum(torch.sum(neg, -1)\/num_neg)\n        return loss\n"}