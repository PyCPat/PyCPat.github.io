{"BEFORE":"        c_onehot = c_\n\n        x = self.conv_layer_1(x)\n\n        x = self.down_sample_1(x)\n        x = self.down_sample_2(x)\n        x = self.down_sample_3(x)\n        x_ = self.down_sample_4(x)\n\n        h = torch.sum(x_, dim=(2, 3))\n\n        x = self.fully_connected(h)\n\n        p = self.projection(c_onehot)\n\n        x += torch.sum(p * h, dim=1, keepdim=True)\n","AFTER":"        c_onehot = torch.cat((c, c_), dim=1).to(self.device)\n\n        x = self.conv_layer_1(x)\n\n        x = self.down_sample_1(x)\n        x = self.down_sample_2(x)\n        x = self.down_sample_3(x)\n        x_ = self.down_sample_4(x)\n\n        h = torch.sum(x_, dim=(2, 3))\n        x = self.fully_connected(x_.permute(0, 2, 3, 1)).permute(0, 3, 1, 2)  # (b, 1, h, w)\n        p = self.projection(c_onehot)  # (b, 512)\n\n        in_prod = p * h\n\n        x = x.view(x.size(0), -1)\n        x = torch.mean(x, dim=-1) + torch.mean(in_prod, dim=-1)\n"}