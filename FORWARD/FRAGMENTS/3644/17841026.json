{"BEFORE":"        sin_inp_x = torch.einsum(\"i,j->ij\", pos_x, self.inv_freq)\n        sin_inp_y = torch.einsum(\"i,j->ij\", pos_y, self.inv_freq)\n        emb_x = torch.cat((sin_inp_x.sin(), sin_inp_x.cos()), dim=-1).unsqueeze(1)\n        emb_y = torch.cat((sin_inp_y.sin(), sin_inp_y.cos()), dim=-1)\n","AFTER":"        sin_inp_x = torch.einsum(\"i,j->ij\", pos_x, self.inv_freq)\n        sin_inp_y = torch.einsum(\"i,j->ij\", pos_y, self.inv_freq)\n        emb_x = get_emb(sin_inp_x).unsqueeze(1)\n        emb_y = get_emb(sin_inp_y)\n"}