{"BEFORE":"        if self.gate_type == 'features':\n            bsz, length, dim = _data[self.input_name].shape\n            self.scale = self.scale.repeat(bsz, length, 1)\n        elif self.gate_type == 'heads':\n            bsz, heads, length, head_dim = _data[self.input_name].shape\n            self.scale = self.scale.repeat(bsz, 1, length, 1)\n        else:\n            print(f\"self.gate_type: {self.gate_type}, is not available!\")\n\n        _data[self.output_name] = _data[self.input_name] * self.scale\n","AFTER":"        _data[self.output_name] = torch.einsum(f'{self.einsum_in_1},{self.einsum_in_2}->{self.einsum_in_1}', _data[self.input_name], self.scale)\n"}