{"BEFORE":"        if len(token_index) == 1:\n            self_attn_mask = self.token_indices < token_index + 1\n        else:\n            self_attn_mask = self.token_indices[:len(token_index)][None, :] < (token_index + 1)[:, None]\n        self_attn_mask = self_attn_mask[None][[0] * decoder_state.shape[0]]\n","AFTER":"        if token_index.shape[1] == 1:\n            self_attn_mask = self.token_indices <= token_index\n        else:\n            self_attn_mask = self.token_indices[:token_index.shape[1]][None, None, :] <= token_index[:, :, None]\n"}