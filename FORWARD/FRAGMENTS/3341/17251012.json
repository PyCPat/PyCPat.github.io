{"BEFORE":"        M = r.size(-1) - 1\n\n        # Make Toeplitz matrix.\n        r_0M = r[..., :-1]\n        r_M1 = r_0M[..., 1:].flip(-1)\n        r_MM = torch.cat((r_M1, r_0M), dim=-1)\n        R = r_MM.unfold(-1, M, 1).flip(-2)\n\n        # Solve system.\n        r_0 = r[..., 0]\n","AFTER":"        R = symmetric_toeplitz(r[..., :-1])\n\n        # Solve system.\n        r1 = r[..., 1:]\n        a = torch.einsum(\"...mn,...m->...n\", R.inverse(), -r1)\n\n        # Compute gain.\n        if \"K\" in self.out_format:\n            r0 = r[..., 0]\n"}