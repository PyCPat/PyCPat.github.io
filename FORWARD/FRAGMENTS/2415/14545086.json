{"BEFORE":"        y_true = y_true.view(y_true.shape[0]*y_true.shape[1], -1)  # [btz*ner_vocab_size, seq_len*seq_len]\n        y_pred = y_pred.view(y_pred.shape[0]*y_pred.shape[1], -1)  # [btz*ner_vocab_size, seq_len*seq_len]\n\n        y_pred = (1-2*y_true) * y_pred\n        y_pred_pos = y_pred - (1-y_true) * 1e12\n        y_pred_neg = y_pred - y_true * 1e12\n\n        y_pred_pos = torch.cat([y_pred_pos, torch.zeros(y_pred_pos.shape[0], 1, device=y_pred_pos.device)], dim=-1)\n        y_pred_neg = torch.cat([y_pred_neg, torch.zeros(y_pred_neg.shape[0], 1, device=y_pred_neg.device)], dim=-1)\n","AFTER":"        y_pred_pos = y_pred - (1-y_true) * 1e12\n        y_pred_neg = y_pred - y_true * 1e12\n\n        y_pred_pos = torch.cat([y_pred_pos, torch.zeros_like(y_pred_pos[..., :1])], dim=-1)\n        y_pred_neg = torch.cat([y_pred_neg, torch.zeros_like(y_pred_neg[..., :1])], dim=-1)\n"}