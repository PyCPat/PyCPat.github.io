{"BEFORE":"        labels = a[\"labels\"]\n        a.pop(\"labels\")\n        b.pop(\"labels\")\n        output_a = self.model_a(**a)[1]  # [bs, seq_len, 768]\n        output_b = self.model_b(**b)[1]\n        output = torch.cat([output_a, output_b, output_a - output_b], dim=1)\n        logits = self.linear(output)\n        loss = self.loss_fct(logits, labels)\n","AFTER":"        labels = a.pop('labels')\n        b.pop('labels')\n        output_a = self.model_a(**a)\n        output_b = self.model_b(**b)\n        embeddings_a = mean_pooling(output_a,  a['attention_mask'])\n        embeddings_b = mean_pooling(output_b, b['attention_mask'])\n        output = torch.cat([embeddings_a, embeddings_b, embeddings_a-embeddings_b], dim=1)\n        logits = self.classifier(output)\n        loss = self.criterion(logits, labels)\n"}