{"BEFORE":"        return x\n","AFTER":"        b = data.shape[0]\n        data = fourier_encode(data, self.num_fourier_features)\n\n        x = repeat(self.latents, 'n d -> b n d', b = b)\n\n        for cross_attn, cross_ff, latent_attn, latent_ff in self.layers:\n            x = cross_attn(x, context = data) + x\n            x = cross_ff(x) + x\n            x = latent_attn(x) + x\n            x = latent_ff(x) + x\n\n        x = x.mean(dim = -2)\n        return self.to_logits(x)\n"}