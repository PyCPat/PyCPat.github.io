{"BEFORE":"        half_dim = self.dim \/\/ 2\n        emb = math.log(10000) \/ (half_dim - 1)\n        emb = torch.exp(torch.arange(half_dim, device=device) * -emb)\n        emb = x[:, None] * emb[None, :]\n        emb = torch.cat((emb.sin(), emb.cos()), dim=-1)\n        return emb\n","AFTER":"        shape = input.shape\n        sinusoid_in = torch.ger(input.view(-1).float(), self.inv_freq)\n        pos_emb = torch.cat([sinusoid_in.sin(), sinusoid_in.cos()], dim=-1)\n        pos_emb = pos_emb.view(*shape, self.dim)\n        return pos_emb\n"}