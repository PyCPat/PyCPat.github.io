{"BEFORE":"        rel_coors = rearrange(coors, 'b i d -> b i () d') - rearrange(coors, 'b j d -> b () j d')\n\n        # calculate nearest neighbors\n\n        nbhd_indices = None\n        if num_nn > 0 and num_nn < n:\n            rel_dist = rel_coors.norm(dim = -1, p = 2)\n            nbhd_indices = rel_dist.topk(num_nn, dim = -1, largest = False).indices\n\n        # main network\n\n        for attn, ff in self.layers:\n","AFTER":"        if exists(self.token_emb):\n            feats = self.token_emb(feats)\n\n        # main network\n\n        for attn, ff in self.layers:\n"}