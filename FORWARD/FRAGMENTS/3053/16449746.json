{"BEFORE":"        query_len = default(query_len, qk.shape[1])\n        t = query_len\n\n        q = qk[:, 0:query_len]\n        qk = F.normalize(qk, 2, dim=-1).type(q.type())\n\n        dot = torch.einsum('bie,bje->bij', q, qk)\n","AFTER":"        _, seq_len, dim = qk.shape\n        query_len = default(query_len, seq_len)\n        t = query_len\n\n        q = qk[:, 0:query_len]\n        qk = F.normalize(qk, 2, dim=-1).type(q.type())\n\n        dot = torch.einsum('bie,bje->bij', q, qk) * (dim ** -0.5)\n"}