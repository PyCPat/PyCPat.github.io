{"BEFORE":"        memories = self.values[memory_indices]\n        return memories\n","AFTER":"        if memory_indices.ndim == 2:\n            memory_indices = rearrange(memory_indices, '... -> ... 1')\n\n        memory_indices = rearrange(memory_indices, 'b n h -> b h n')\n\n        values = repeat(self.values, 'h n d -> b h n d', b = memory_indices.shape[0])\n        memory_indices = repeat(memory_indices, 'b h n -> b h n d', d = values.shape[-1])\n\n        memories = values.gather(2, memory_indices)\n\n        return rearrange(memories, 'b h n d -> b n (h d)')\n"}