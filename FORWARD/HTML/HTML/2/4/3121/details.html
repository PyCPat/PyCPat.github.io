<html><h3>Pattern ID :3121
</h3><img src='16778816.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            final_chunk_state_list.append(final_state)

        if self.use_gru:
            <a id="change">return </a>x<a id="change">, final_chunk_state_list, init_state_c_box</a>
        else:
            final_chunk_state_h_list = [final_chunk_state_list[i][0] for i in range(self.num_rnn_layers)]
            final_chunk_state_c_list = [final_chunk_state_list[i][1] for i in range(self.num_rnn_layers)]
            final_chunk_state_h_box = torch.concat(final_chunk_state_h_list, dim=0)</code></pre><h3>After Change</h3><pre><code class='java'>
                init_state_list = init_state_h_list
            else:
                init_state_h_list = torch.split(init_state_h_box, 1, dim=0)
                init_state_c_list<a id="change"> = </a><a id="change">torch.split(</a>init_state_c_box, 1<a id="change">, dim=0)</a>
                init_state_list = [(init_state_h_list[i], init_state_c_list[i]) for i in range(self.num_rnn_layers)]
        else:
            init_state_list = [None] * self.num_rnn_layers
        final_chunk_state_list = []</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/yeyupiaoling/masr/commit/46af03716daf8b3f45651ba83a57444c1997ef4f#diff-c4d330638d5d220ca0df32668bc806ac33c238eb36c2ac133a325b7887340810L59' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16778816</div><div id='project'> Project Name: yeyupiaoling/masr</div><div id='commit'> Commit Name: 46af03716daf8b3f45651ba83a57444c1997ef4f</div><div id='time'> Time: 2022-07-10</div><div id='author'> Author: yeyupiaoling@foxmail.com</div><div id='file'> File Name: masr/model_utils/deepspeech2/rnn.py</div><div id='m_class'> M Class Name: RNNStack</div><div id='n_method'> N Class Name: RNNStack</div><div id='m_method'> M Method Name: forward(5)</div><div id='n_method'> N Method Name: forward(5)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: masr/model_utils/deepspeech2/rnn.py</div><div id='n_file'> N File Name: masr/model_utils/deepspeech2/rnn.py</div><div id='m_start'> M Start Line: 59</div><div id='m_end'> M End Line: 72</div><div id='n_start'> N Start Line: 59</div><div id='n_end'> N End Line: 74</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 returing:
        &#47&#47 GPT2Model/Block[2]/MLP[mlp]/Dropout[dropout]
        &#47&#47 GPT2Model/Block[2]/aten::add5567
        <a id="change">return </a>(self.l_29(self.l_28(torch.mul(input=torch.mul(input=t_33, other=0.5), other=torch.add(input=Tensor.tanh(torch.mul(input=torch.add(input=t_33, other=torch.mul(input=Tensor.pow(t_33, exponent=3), other=0.044715)), other=0.7978845608028654)), other=1))))<a id="change">, t_32</a>)

    def state_dict(self,device=None):
        &#47&#47 we return the state dict of this part as it should be in the original model</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47 GPT2LMHeadModel/GPT2Model[transformer]/Block[3]/Attention[attn]/Conv1D[c_attn]
        &#47&#47 GPT2LMHeadModel/GPT2Model[transformer]/Block[3]/Attention[attn]/prim::Constant5779
        &#47&#47 GPT2LMHeadModel/GPT2Model[transformer]/Block[3]/Attention[attn]/prim::Constant5780
        t_35 = <a id="change">Tensor.split(</a>self.l_31(self.l_30(t_34))<a id="change">, split_size=768, dim=2)</a>
        t_36 = t_35[0]
        t_37<a id="change"> = </a>t_35[1]
        t_38 = t_35[2]
        &#47&#47 calling torch.div with arguments:
        &#47&#47 GPT2LMHeadModel/GPT2Model[transformer]/Block[3]/Attention[attn]/aten::matmul5854</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/saareliad/ftpipe/commit/9ddf98456ca57cac3a4a982fc519c5a71642dc25#diff-4d93af50bd9b6dc7752538156bde96fadf361ac3f37eb0019e2bbf01206492abL311' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16778808</div><div id='project'> Project Name: saareliad/ftpipe</div><div id='commit'> Commit Name: 9ddf98456ca57cac3a4a982fc519c5a71642dc25</div><div id='time'> Time: 2020-03-10</div><div id='author'> Author: saareliad@campus.technion.ac.il</div><div id='file'> File Name: models/partitioned/gpt2.py</div><div id='m_class'> M Class Name: Partition0</div><div id='n_method'> N Class Name: Partition0</div><div id='m_method'> M Method Name: forward(2)</div><div id='n_method'> N Method Name: forward(2)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: models/partitioned/gpt2.py</div><div id='n_file'> N File Name: models/partitioned/gpt2.py</div><div id='m_start'> M Start Line: 460</div><div id='m_end'> M End Line: 467</div><div id='n_start'> N Start Line: 396</div><div id='n_end'> N End Line: 430</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

            attn_list = [attn]

        <a id="change">return </a>causal_logits_list<a id="change">, attn_list</a>


    def construct_mask(self, N):
        masks = []</code></pre><h3>After Change</h3><pre><code class='java'>
        prior = self.prior.to(device)

        box_size_list = [proposal.bbox.size(0) for proposal in proposals]
        feature_split<a id="change"> = </a><a id="change">x.split(</a>box_size_list<a id="change">)</a>
        xzs = [self.z_dic(feature_pre_obj, dic_z, prior) for feature_pre_obj in feature_split]

        causal_logits_list = [self.causal_score(xz) for xz in xzs]
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/wangt-cn/vc-r-cnn/commit/51a882a36e8777715669773236cd8285b0d38986#diff-be62d5533104d4c97b3017be21afc11ab8aaaf90848ecea92447a04acbbb4e06L94' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 16778812</div><div id='project'> Project Name: wangt-cn/vc-r-cnn</div><div id='commit'> Commit Name: 51a882a36e8777715669773236cd8285b0d38986</div><div id='time'> Time: 2020-02-21</div><div id='author'> Author: wangt97@hotmail.com</div><div id='file'> File Name: vc_rcnn/vc_rcnn/modeling/roi_heads/box_head/roi_box_predictors.py</div><div id='m_class'> M Class Name: CausalPredictor</div><div id='n_method'> N Class Name: CausalPredictor</div><div id='m_method'> M Method Name: forward(3)</div><div id='n_method'> N Method Name: forward(3)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: vc_rcnn/vc_rcnn/modeling/roi_heads/box_head/roi_box_predictors.py</div><div id='n_file'> N File Name: vc_rcnn/vc_rcnn/modeling/roi_heads/box_head/roi_box_predictors.py</div><div id='m_start'> M Start Line: 96</div><div id='m_end'> M End Line: 123</div><div id='n_start'> N Start Line: 91</div><div id='n_end'> N End Line: 101</div><BR>