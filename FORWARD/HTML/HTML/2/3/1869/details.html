<html><h3>Pattern ID :1869
</h3><img src='13149064.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            if i != self.ignore_index:
                dice_loss = dice(predict[:, i], target[:, i])
                if self.weight is not None:
                    <a id="change">assert </a>self.weight.shape[0] == target.shape[1], \
                        &quotExpect weight shape [{}], get[{}]&quot.format(target.shape[1], self.weight.shape[0])
                    dice_loss *= self.weight[i]
                total_loss += dice_loss</code></pre><h3>After Change</h3><pre><code class='java'>

        dice = 0.
        &#47&#47 dice系数的定义
        for i in range(<a id="change">pred.size(1</a><a id="change">)</a>):
            dice += 2 * (pred[:,i] * target[:,i]).sum(dim=1).sum(dim=1).sum(dim=1) / (pred[:,i].pow(2).sum(dim=1).sum(dim=1).sum(dim=1) +
                                                target[:,i].pow(2).sum(dim=1).sum(dim=1).sum(dim=1) + smooth)
        &#47&#47 返回的是dice距离</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 2</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/lee-zq/3dunet-pytorch/commit/070a8816879b33e97a9541e35cc5b2bfaf1bcd76#diff-afc9c0f856a1fa54a2d35dfcd375a176b7b736953195238a3a51870eef4314bbL18' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 13149064</div><div id='project'> Project Name: lee-zq/3dunet-pytorch</div><div id='commit'> Commit Name: 070a8816879b33e97a9541e35cc5b2bfaf1bcd76</div><div id='time'> Time: 2021-05-22</div><div id='author'> Author: zq_lee@163.com</div><div id='file'> File Name: utils/loss.py</div><div id='m_class'> M Class Name: DiceLoss</div><div id='n_method'> N Class Name: DiceLoss</div><div id='m_method'> M Method Name: forward(3)</div><div id='n_method'> N Method Name: forward(3)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: utils/loss.py</div><div id='n_file'> N File Name: utils/loss.py</div><div id='m_start'> M Start Line: 78</div><div id='m_end'> M End Line: 93</div><div id='n_start'> N Start Line: 18</div><div id='n_end'> N End Line: 27</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        batch_size = input.size(0)
        time_step = input.size(1)
        feature_dim = input.size(2)
        <a id="change">assert </a>feature_dim == self.n_input

        self.agent1_action = []
        self.agent1_prob = []</code></pre><h3>After Change</h3><pre><code class='java'>
        labtest = x[:, :, self.demo_dim :]

        batch_size = labtest.size(0)
        time_step = <a id="change">labtest.size(1</a><a id="change">)</a>
        feature_dim = labtest.size(2)
        assert feature_dim == self.lab_dim

        self.agent1_action = []</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/yhzhu99/covid-ehr-benchmarks/commit/41e28f49dd30d760c6c439a5cf41590262c9b76b#diff-5fdd32b806c6289f77045eb16c679e729eabff875bba907ebc44d204c4cc7bbaL118' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 13149066</div><div id='project'> Project Name: yhzhu99/covid-ehr-benchmarks</div><div id='commit'> Commit Name: 41e28f49dd30d760c6c439a5cf41590262c9b76b</div><div id='time'> Time: 2022-06-24</div><div id='author'> Author: yhzhu99@gmail.com</div><div id='file'> File Name: app/models/backbones/agent.py</div><div id='m_class'> M Class Name: Agent</div><div id='n_method'> N Class Name: Agent</div><div id='m_method'> M Method Name: forward(2)</div><div id='n_method'> N Method Name: forward(3)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: app/models/backbones/agent.py</div><div id='n_file'> N File Name: app/models/backbones/agent.py</div><div id='m_start'> M Start Line: 118</div><div id='m_end'> M End Line: 204</div><div id='n_start'> N Start Line: 117</div><div id='n_end'> N End Line: 201</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>

        features = functional.adaptive_avg_pool2d(features, 1).squeeze(-1).squeeze(-1)

        <a id="change">assert </a>features.size(1) == self.in_features
        pre_landmarks = self.fc(features)

        return pre_landmarks</code></pre><h3>After Change</h3><pre><code class='java'>

    def forward(self, x):
        p4, p8, p16, p32 = self.backbone(x)
        p32 = p32.view(<a id="change">p32.size(0</a><a id="change">)</a>, -1)
        output = self.fc(p32)
        return output, p8
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/github-luffy/pfld_68points_pytorch/commit/d1c8309abf220b0337f742583ce292007ade8203#diff-d2dc054e0176a340cb7fa419c72dcadbc64c10c79507f25cdf7fe537cbd6ee12L1579' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 13149061</div><div id='project'> Project Name: github-luffy/pfld_68points_pytorch</div><div id='commit'> Commit Name: d1c8309abf220b0337f742583ce292007ade8203</div><div id='time'> Time: 2020-08-14</div><div id='author'> Author: luffyxq@qq.com</div><div id='file'> File Name: model2.py</div><div id='m_class'> M Class Name: EfficientNet</div><div id='n_method'> N Class Name: EfficientLM</div><div id='m_method'> M Method Name: forward(2)</div><div id='n_method'> N Method Name: forward(2)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: model2.py</div><div id='n_file'> N File Name: model2.py</div><div id='m_start'> M Start Line: 1581</div><div id='m_end'> M End Line: 1588</div><div id='n_start'> N Start Line: 724</div><div id='n_end'> N End Line: 727</div><BR>