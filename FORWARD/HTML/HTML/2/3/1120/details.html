<html><h3>Pattern ID :1120
</h3><img src='4040229.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        src = torch.ones_like(label.unsqueeze(1), dtype=inp.dtype, device=inp.device) - self.m
        sigma.scatter_(dim=1, index=label.unsqueeze(1), src=src)

        <a id="change">return </a><a id="change">self.loss(</a>a * (inp - sigma) * self.gamma, label<a id="change">)</a>


if __name__ == "__main__":
    feature = torch.rand(32, 128)</code></pre><h3>After Change</h3><pre><code class='java'>
        sp.backward(gradient=z * ap * torch.softmax(logit_p, dim=0))
        sn.backward(gradient=z * an * torch.softmax(logit_n, dim=0))

        <a id="change">return </a>loss.detach()


if __name__ == "__main__":</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/tinyzeamays/circleloss/commit/9c909ec6274b1c9c139a62f9f84ecf91c5edee35#diff-ee4498af95089c1dacb3bbdedbf8cffa6eecc60617a8a1d405b07f6f81510abbL23' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 4040229</div><div id='project'> Project Name: tinyzeamays/circleloss</div><div id='commit'> Commit Name: 9c909ec6274b1c9c139a62f9f84ecf91c5edee35</div><div id='time'> Time: 2020-04-03</div><div id='author'> Author: 1049793129@qq.com</div><div id='file'> File Name: circle_loss.py</div><div id='m_class'> M Class Name: CircleLoss</div><div id='n_method'> N Class Name: CircleLossBackward</div><div id='m_method'> M Method Name: forward(3)</div><div id='n_method'> N Method Name: forward(3)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: circle_loss.py</div><div id='n_file'> N File Name: circle_loss.py</div><div id='m_start'> M Start Line: 23</div><div id='m_end'> M End Line: 34</div><div id='n_start'> N Start Line: 43</div><div id='n_end'> N End Line: 58</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        X_ = self.linear1(X_)
        X_ = F.relu(X_)
        y = self.linear2(X_[target_x])
        loss = <a id="change">self.loss(</a>y, target<a id="change">)</a>
        <a id="change">return </a>loss, y, Ws


class GTLayer(nn.Module):</code></pre><h3>After Change</h3><pre><code class='java'>
            X_ = self.linear1(X_)
            X_ = F.relu(X_)
            y = self.linear2(X_)
        <a id="change">return </a>y


class GTLayer(nn.Module):</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/bupt-gamma/openhgnn/commit/51823d529be6db0eb8844c1c0f417b267644c197#diff-0d8fddfe17c2f578af64fd1798d352e06f9a740d59feca09167ad1303b46ca15L70' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 4040228</div><div id='project'> Project Name: bupt-gamma/openhgnn</div><div id='commit'> Commit Name: 51823d529be6db0eb8844c1c0f417b267644c197</div><div id='time'> Time: 2021-03-01</div><div id='author'> Author: theheavenszhao@outlook.com</div><div id='file'> File Name: openhgnn/model/GTN.py</div><div id='m_class'> M Class Name: GTN</div><div id='n_method'> N Class Name: GTN</div><div id='m_method'> M Method Name: forward(2)</div><div id='n_method'> N Method Name: forward(5)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: openhgnn/model/GTN.py</div><div id='n_file'> N File Name: openhgnn/model/GTN.py</div><div id='m_start'> M Start Line: 70</div><div id='m_end'> M End Line: 96</div><div id='n_start'> N Start Line: 68</div><div id='n_end'> N End Line: 99</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
            (creators_1d, destroyers_1d), 1
        )

        loss = <a id="change">self.loss(
            </a>[persistence_diagram_0d, persistence_diagram_1d]<a id="change">
        )</a>

        <a id="change">return </a>loss
</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47    [persistence_diagram_0d, persistence_diagram_1d]
        &#47&#47)

        <a id="change">return </a>[persistence_diagram_0d, persistence_diagram_1d], self.pd_target
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/aidos-lab/pytorch-topological/commit/9984e5cae422166c33a6549a058b31d68585563b#diff-3ee42b5ac4734955417c9042773daa3ce9df8e8c198d1768384d9a78f21c1f03L44' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 4040227</div><div id='project'> Project Name: aidos-lab/pytorch-topological</div><div id='commit'> Commit Name: 9984e5cae422166c33a6549a058b31d68585563b</div><div id='time'> Time: 2021-12-10</div><div id='author'> Author: bastian@rieck.me</div><div id='file'> File Name: pytorch_topological/nn/vietoris_rips.py</div><div id='m_class'> M Class Name: ModelSpaceLoss</div><div id='n_method'> N Class Name: VietorisRips</div><div id='m_method'> M Method Name: forward(1)</div><div id='n_method'> N Method Name: forward(1)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: pytorch_topological/nn/vietoris_rips.py</div><div id='n_file'> N File Name: pytorch_topological/nn/vietoris_rips.py</div><div id='m_start'> M Start Line: 90</div><div id='m_end'> M End Line: 102</div><div id='n_start'> N Start Line: 85</div><div id='n_end'> N End Line: 97</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        src = torch.ones_like(label.unsqueeze(1), dtype=inp.dtype, device=inp.device) - self.m
        sigma.scatter_(dim=1, index=label.unsqueeze(1), src=src)

        <a id="change">return </a><a id="change">self.loss(</a>a * (inp - sigma) * self.gamma, label<a id="change">)</a>


def convert_label_to_similarity(normed_feature: Tensor, label: Tensor) -&gt; Tuple[Tensor, Tensor]:
    similarity_matrix = normed_feature @ normed_feature.transpose(1, 0)</code></pre><h3>After Change</h3><pre><code class='java'>

        loss = self.soft_plus(torch.logsumexp(logit_n, dim=0) + torch.logsumexp(logit_p, dim=0))

        <a id="change">return </a>loss


if __name__ == "__main__":</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/tinyzeamays/circleloss/commit/61758eefe091cf44f4de87aadd84fcb2bc377f94#diff-ee4498af95089c1dacb3bbdedbf8cffa6eecc60617a8a1d405b07f6f81510abbL23' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 4040226</div><div id='project'> Project Name: tinyzeamays/circleloss</div><div id='commit'> Commit Name: 61758eefe091cf44f4de87aadd84fcb2bc377f94</div><div id='time'> Time: 2020-04-04</div><div id='author'> Author: 1049793129@qq.com</div><div id='file'> File Name: circle_loss.py</div><div id='m_class'> M Class Name: CircleLossLikeCE</div><div id='n_method'> N Class Name: CircleLoss</div><div id='m_method'> M Method Name: forward(3)</div><div id='n_method'> N Method Name: forward(3)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: circle_loss.py</div><div id='n_file'> N File Name: circle_loss.py</div><div id='m_start'> M Start Line: 24</div><div id='m_end'> M End Line: 35</div><div id='n_start'> N Start Line: 28</div><div id='n_end'> N End Line: 39</div><BR>