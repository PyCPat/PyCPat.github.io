<html><h3>Pattern ID :1278
</h3><img src='4484164.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    &#47&#47 --------------------------------------------------------------------------

    def forward(self, input, hx=None):
        output_size<a id="change"> = </a>(
            int((<a id="change">input.size(-1</a><a id="change">)</a> - self.kernel_size + 2 * self.padding_ih)<a id="change"> / </a>self.stride) + 1
        )
        &#47&#47 Handle the case of no hidden state provided
        if hx is None:
            hx<a id="change"> = </a>torch.zeros(input.size(0), self.h_channels, output_size, device=input.device)
        &#47&#47 Run the optimized convgru-cell
        return _opt_convgrucell_1d(
            input,</code></pre><h3>After Change</h3><pre><code class='java'>
        if h_prev is None:
            h_prev = self.init_hidden(input)
        print(f"input: {input.shape} prev: {h_prev.shape}")
        combined<a id="change"> = </a><a id="change">torch.cat(</a>(input, h_prev)<a id="change">, dim=1)</a>  &#47&#47 concatenate along channel axis

        combined_conv = F.sigmoid(self.conv_zr(combined))
</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 6</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/openclimatefix/skillful_nowcasting/commit/02c5ceadd01484d6ac8bce848ff76446fe7a6917#diff-cee00a565d888c684ec40bd3eac27669aa3223b223a80ae9f871383a9fb64917L69' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 4484164</div><div id='project'> Project Name: openclimatefix/skillful_nowcasting</div><div id='commit'> Commit Name: 02c5ceadd01484d6ac8bce848ff76446fe7a6917</div><div id='time'> Time: 2021-10-18</div><div id='author'> Author: jacob@bieker.tech</div><div id='file'> File Name: nowcasting_gan/layers/ConvGRU.py</div><div id='m_class'> M Class Name: ConvGRU1DCell</div><div id='n_method'> N Class Name: ConvGRUCell</div><div id='m_method'> M Method Name: forward(3)</div><div id='n_method'> N Method Name: forward(3)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: nowcasting_gan/layers/ConvGRU.py</div><div id='n_file'> N File Name: nowcasting_gan/layers/ConvGRU.py</div><div id='m_start'> M Start Line: 83</div><div id='m_end'> M End Line: 101</div><div id='n_start'> N Start Line: 69</div><div id='n_end'> N End Line: 82</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        if inputs is not None:
            &#47&#47 Grouping multiple frames if necessary
            if inputs.size(-1) == self.mel_dim:
                inputs<a id="change"> = </a>inputs.reshape(B, <a id="change">inputs.size(1</a><a id="change">) // </a>self.r, -1)
            assert inputs.size(-1) == self.mel_dim * self.r
            T_decoder<a id="change"> = </a>inputs.size(1)

        &#47&#47 Time first (T&quot, B, mel_dim*r)
        if inputs is not None:</code></pre><h3>After Change</h3><pre><code class='java'>
                    break

        &#47&#47 To tensor
        mel_outputs<a id="change"> = </a><a id="change">torch.cat(</a>mel_outputs<a id="change">, dim=1)</a> &#47&#47 (B, T_decoder, mel_dim)
        attn_scores = torch.cat(attn_scores, dim=1) &#47&#47 (B, T_decoder/r, T_encoder)
        stop_tokens = torch.cat(stop_tokens, dim=1) &#47&#47 (B, T_decoder)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/thuhcsi/tacotron/commit/fea9ec535ec373aad564646f4f292fbee0217c29#diff-d9b8d279159e71117d405f97592a8727c16e635c5fc8b968d2c0b3bf1f1d9df1L70' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 4484199</div><div id='project'> Project Name: thuhcsi/tacotron</div><div id='commit'> Commit Name: fea9ec535ec373aad564646f4f292fbee0217c29</div><div id='time'> Time: 2021-03-18</div><div id='author'> Author: johnson.tsing@gmail.com</div><div id='file'> File Name: model/tacotron.py</div><div id='m_class'> M Class Name: Decoder</div><div id='n_method'> N Class Name: Decoder</div><div id='m_method'> M Method Name: forward(4)</div><div id='n_method'> N Method Name: forward(4)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: model/tacotron.py</div><div id='n_file'> N File Name: model/tacotron.py</div><div id='m_start'> M Start Line: 87</div><div id='m_end'> M End Line: 187</div><div id='n_start'> N Start Line: 88</div><div id='n_end'> N End Line: 180</div><BR>'><BR><BR><BR><h3>Before Change</h3><pre><code class='java'>
        if inputs is not None:
            &#47&#47 Grouping multiple frames if necessary
            if inputs.size(-1) == self.mel_dim:
                inputs<a id="change"> = </a>inputs.reshape(B, <a id="change">inputs.size(1</a><a id="change">) // </a>self.r, -1)
            assert inputs.size(-1) == self.mel_dim * self.r
            T_decoder<a id="change"> = </a>inputs.size(1)

        &#47&#47 Time first (T&quot, B, mel_dim*r)
        if inputs is not None:</code></pre><h3>After Change</h3><pre><code class='java'>
                    break

        &#47&#47 To tensor
        mel_outputs<a id="change"> = </a><a id="change">torch.cat(</a>mel_outputs<a id="change">, dim=1)</a> &#47&#47 (B, T_decoder, mel_dim)
        attn_scores = torch.cat(attn_scores, dim=1) &#47&#47 (B, T_decoder/r, T_encoder)
        stop_tokens = torch.cat(stop_tokens, dim=1) &#47&#47 (B, T_decoder)
</code></pre>'><BR><BR><BR><BR><div id='link'><a href='https://github.com/thuhcsi/tacotron/commit/fea9ec535ec373aad564646f4f292fbee0217c29#diff-7ad5d3b60745b0b46860cc4003e6b1af82b421d3df25282bfacabd1db690e1b9L110' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 4484128</div><div id='project'> Project Name: thuhcsi/tacotron</div><div id='commit'> Commit Name: fea9ec535ec373aad564646f4f292fbee0217c29</div><div id='time'> Time: 2021-03-18</div><div id='author'> Author: johnson.tsing@gmail.com</div><div id='file'> File Name: model/tacotron2.py</div><div id='m_class'> M Class Name: Decoder</div><div id='n_method'> N Class Name: Decoder</div><div id='m_method'> M Method Name: forward(4)</div><div id='n_method'> N Method Name: forward(4)</div><div id='m_parent_class'> M Parent Class: nn.Module</div><div id='n_parent_class'> N Parent Class: nn.Module</div><div id='m_file'> M File Name: model/tacotron2.py</div><div id='n_file'> N File Name: model/tacotron2.py</div><div id='m_start'> M Start Line: 127</div><div id='m_end'> M End Line: 224</div><div id='n_start'> N Start Line: 127</div><div id='n_end'> N End Line: 216</div><BR>