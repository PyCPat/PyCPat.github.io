{"BEFORE":"            nn.Conv2d(dim, hidden_dim, 1),\n            Rearrange('b d w h -> b (d w) h'),\n            nn.Conv1d(hidden_dim * w, w * w, 1, groups=segment),\n","AFTER":"        self.segment = segment\n        self.reshape = Rearrange('b h w (s d) -> b h s w d', s = segment)\n\n        self.Wd = nn.ModuleList([nn.Linear(dim, hidden_dim) for i in range(segment)])\n        self.attend = nn.Sequential(\n            Rearrange('b h w (s d) -> b h s (w d)', s = segment),\n            nn.Linear(int(hidden_dim * w), w * w),\n            Rearrange('b h s (w1 w2) -> b h s w1 w2', w1 = w),\n            nn.Softmax(dim = -1),\n        )\n        self.recover = Rearrange('b h s w d -> b h w (s d)', s = segment)\n        self.proc = nn.Linear(dim, dim)\n"}