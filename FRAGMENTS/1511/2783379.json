{"BEFORE":"        self.scale = query_key_dim ** -0.5\n\n        hidden_dim = default(hidden_dim, dim * 2)\n        self.norm = nn.LayerNorm(dim)\n        self.to_hidden = nn.Linear(dim, hidden_dim * 2)\n\n        self.to_qk = nn.Linear(dim, query_key_dim, bias = False)\n","AFTER":"        hidden_dim = int(expansion_factor * dim)\n\n        self.norm = nn.LayerNorm(dim)\n        self.causal = causal\n\n        self.to_hidden = nn.Sequential(\n            nn.Linear(dim, hidden_dim * 2),\n            nn.SiLU()\n        )\n\n        self.to_qk = nn.Sequential(\n            nn.Linear(dim, query_key_dim),\n            nn.SiLU()\n        )\n"}