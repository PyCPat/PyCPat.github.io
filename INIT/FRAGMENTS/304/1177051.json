{"BEFORE":"        self.q_out = nn.Linear(dim_head, dim_head, bias = False)\n        self.attn_out = nn.Linear(dim_head, dim_head, bias = False)\n        self.out_bias = nn.Parameter(torch.zeros(1, 1, dim_head))\n\n        self.q_gate = nn.Linear(dim_head, dim_head, bias = False)\n        self.attn_gate = nn.Linear(dim_head, dim_head, bias = False)\n        self.gate_bias = nn.Parameter(torch.zeros(1, 1, dim_head))\n","AFTER":"        inner_dim = dim_head * heads\n        self.heads = heads\n        self.scale = dim_head ** -0.5\n\n        self.to_q = nn.Linear(dim, inner_dim, bias = False)\n        self.to_kv = nn.Linear(dim, inner_dim * 2, bias = False)\n\n        self.dropout = nn.Dropout(dropout)\n\n        self.aoa = nn.Sequential(\n            nn.Linear(2 * inner_dim, 2 * dim),\n            nn.GLU(),\n            nn.Dropout(aoa_dropout)\n        )\n"}