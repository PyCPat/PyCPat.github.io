{"BEFORE":"            nn.Conv2d(dim, hidden_dim, 1),\n            Rearrange('b d h w -> b (d h) w'),\n            nn.Conv1d(hidden_dim * h, h * h, 1, groups=segment),\n","AFTER":"        self.segment = segment\n        self.reshape = Rearrange('b h w (s d) -> b w s h d', s = segment)\n\n        self.Wd = nn.ModuleList([nn.Linear(dim, hidden_dim) for i in range(segment)])\n        self.attend = nn.Sequential(\n            Rearrange('b h w (s d) -> b w s (h d)', s = segment),\n            nn.Linear(int(hidden_dim * h), h * h),\n            Rearrange('b w s (h1 h2) -> b w s h1 h2', h1 = h),\n            nn.Softmax(dim = -1),\n        )\n        self.recover = Rearrange('b w s h d -> b h w (s d)', s = segment)\n        self.proc = nn.Linear(dim, dim)\n"}