{"BEFORE":"                nn.Linear(heads, 1),\n                Rearrange('... () -> ...')\n            )\n        else:\n            self.coors_mlp = nn.Sequential(\n                nn.Linear(heads, coors_hidden_dim),\n                nn.GELU(),\n                nn.Linear(coors_hidden_dim, 1),\n                Rearrange('... () -> ...')\n","AFTER":"                nn.Linear(heads, heads)\n            )\n        else:\n            self.coors_mlp = nn.Sequential(\n                nn.Linear(heads, coors_hidden_dim),\n                nn.GELU(),\n                nn.Linear(coors_hidden_dim, heads)\n            )\n\n        self.coors_gate = nn.Sequential(\n            nn.Linear(heads, heads),\n            nn.Tanh()\n        )\n\n        self.norm_rel_coors = CoorsNorm()\n        self.coors_combine = nn.Parameter(torch.randn(heads))\n"}