{"BEFORE":"                Residual(PreNorm(dim, Attention(dim, heads = heads))),\n","AFTER":"    def __init__(self, dim, depth, heads = 8, cross_attend = False):\n        super().__init__()\n        self.dim = dim\n        self.layers = nn.ModuleList([])\n        for _ in range(depth):\n            self.layers.append(nn.ModuleList([\n                Residual(PreNorm(dim, Attention(dim, heads = heads, causal = True))),\n                Residual(PreNorm(dim, Attention(dim, heads = heads))) if cross_attend else None,\n"}