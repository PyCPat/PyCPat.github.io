<html><h3>Pattern ID :1535
</h3><img src='4053645.png'><BR><BR><BR><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            f_dim, t_dim = self.get_shape(fstride, tstride, input_fdim, input_tdim)
            num_patches = f_dim * t_dim
            self.v.patch_embed.num_patches = num_patches
            <a id="change">print(</a>&quotfrequncey stride={:d}, time stride={:d}&quot.format(fstride, tstride)<a id="change">)</a>
            print(&quotnumber of patches={:d}&quot.format(num_patches))

            new_pos_embed = self.v.pos_embed[:, 2:, :].detach().reshape(1, 1212, 768).transpose(1, 2).reshape(1, 768, 12, 101)
            &#47&#47 if the input sequence length is larger than the original audioset (10s), then cut the positional embedding</code></pre><h3>After Change</h3><pre><code class='java'>
        elif audioset_pretrain == True:
            if audioset_pretrain == True and imagenet_pretrain == False:
                raise ValueError(&quotcurrently model pretrained on only audioset is not supported, please set imagenet_pretrain = True to use audioset pretrained model.&quot)
            <a id="change">if model_size != &quotbase384&quot</a><a id="change">:
                </a>raise ValueError(&quotcurrently only has base384 AudioSet pretrained model.&quot)
            device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
            if os.path.exists(&quot../../pretrained_models/ast_audioset.pth&quot) == False:
                &#47&#47 this model performs 0.4593 mAP on the audioset eval set
                audioset_mdl_url = &quothttps://www.dropbox.com/s/cv4knew8mvbrnvq/audioset_0.4593.pth?dl=1&quot
                wget.download(audioset_mdl_url, out=&quot../../pretrained_models/ast_audioset.pth&quot)
            sd = torch.load(&quot../../pretrained_models/ast_audioset.pth&quot, map_location=device)
            audio_model = ASTModel(label_dim=527, fstride=10, tstride=10, input_fdim=128, input_tdim=1024, imagenet_pretrain=False, audioset_pretrain=False, model_size=&quotbase384&quot, verbose=False)
            audio_model = torch.nn.DataParallel(audio_model)
            audio_model.load_state_dict(sd, strict=False)
            self.v = audio_model.module.v
            self.original_embedding_dim = self.v.pos_embed.shape[2]
            self.mlp_head = nn.Sequential(nn.LayerNorm(self.original_embedding_dim), nn.Linear(self.original_embedding_dim, label_dim))

            f_dim, t_dim = self.get_shape(fstride, tstride, input_fdim, input_tdim)
            num_patches = f_dim * t_dim
            self.v.patch_embed.num_patches = num_patches
            if verbose == True:
                <a id="change">print(</a>&quotfrequncey stride={:d}, time stride={:d}&quot.format(fstride, tstride)<a id="change">)</a>
                print(&quotnumber of patches={:d}&quot.format(num_patches))

            new_pos_embed = self.v.pos_embed[:, 2:, :].detach().reshape(1, 1212, 768).transpose(1, 2).reshape(1, 768, 12, 101)
            &#47&#47 if the input sequence length is larger than the original audioset (10s), then cut the positional embedding</code></pre><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 5</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/yuangongnd/ast/commit/481cd0acb38e73bef9ba24b5d0e5d8bf9e5ccf93#diff-fa273a5074442d85ea3ba8047a77ae9f2615e53c466731de520f24818f3c066aL47' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 4053645</div><div id='project'> Project Name: yuangongnd/ast</div><div id='commit'> Commit Name: 481cd0acb38e73bef9ba24b5d0e5d8bf9e5ccf93</div><div id='time'> Time: 2021-07-20</div><div id='author'> Author: yuangongfdu@gmail.com</div><div id='file'> File Name: src/models/ast_models.py</div><div id='class'> Class Name: ASTModel</div><div id='method'> Method Name: __init__</div><div id='parent_class'> Parent Class: nn.Module</div><BR><BR><div id='link'><a href='https://github.com/tianxiaomo/pytorch-yolov4/commit/90e0325d1ebd39c141b989e09a2a4a6b44781289#diff-dcfeaa5ac3dffd54264034760914588d92fc7395c81eaa9274715840dc28100bL54' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 4053646</div><div id='project'> Project Name: tianxiaomo/pytorch-yolov4</div><div id='commit'> Commit Name: 90e0325d1ebd39c141b989e09a2a4a6b44781289</div><div id='time'> Time: 2020-05-13</div><div id='author'> Author: 1025568329@qq.com</div><div id='file'> File Name: models.py</div><div id='class'> Class Name: Conv_Bn_Activation</div><div id='method'> Method Name: __init__</div><div id='parent_class'> Parent Class: nn.Module</div><BR><BR><div id='link'><a href='https://github.com/tencentyouturesearch/personreid-youreid/commit/a82d51979279b93a4f34eff01d16de2af6f02b4d#diff-0bb3c15e92cf390ebe34d0347c1f8b228f6048214f97b56c95ca086dba70a523L21' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 4053641</div><div id='project'> Project Name: tencentyouturesearch/personreid-youreid</div><div id='commit'> Commit Name: a82d51979279b93a4f34eff01d16de2af6f02b4d</div><div id='time'> Time: 2020-08-13</div><div id='author'> Author: fufuyu@tencent.com</div><div id='file'> File Name: models/baseline.py</div><div id='class'> Class Name: Baseline</div><div id='method'> Method Name: __init__</div><div id='parent_class'> Parent Class: nn.Module</div><BR><BR><div id='link'><a href='https://github.com/tianxiaomo/pytorch-yolov4/commit/cf7d98a55dbc4083909789d30a0fb1db04d9f0c5#diff-dcfeaa5ac3dffd54264034760914588d92fc7395c81eaa9274715840dc28100bL50' target='_blank'>Link</a></div><div id='fragmentid'> Fragment ID: 4053642</div><div id='project'> Project Name: tianxiaomo/pytorch-yolov4</div><div id='commit'> Commit Name: cf7d98a55dbc4083909789d30a0fb1db04d9f0c5</div><div id='time'> Time: 2020-05-13</div><div id='author'> Author: 1025568329@qq.com</div><div id='file'> File Name: models.py</div><div id='class'> Class Name: Conv_Bn_Activation</div><div id='method'> Method Name: __init__</div><div id='parent_class'> Parent Class: nn.Module</div><BR>