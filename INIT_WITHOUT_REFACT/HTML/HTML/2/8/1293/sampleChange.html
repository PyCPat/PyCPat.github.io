<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        intermediate = []
        intermediate_reference_points = []
        for layer in self.layers:
            <a id="change">if reference_points.shape[-1] == 3</a><a id="change">:
                </a>reference_points_input = reference_points[:, :, None] * src_valid_ratios[:, None]   &#47&#47 Only have refererence points in valid areas
            else:
                <a id="change">raise </a><a id="change">ValueError("Currently iterative bbox refinement is not implemented."</a><a id="change">)</a>

            output = layer(output, query_pos, reference_points_input, src, src_spatial_shapes, src_level_start_index, src_padding_mask)

            if self.return_intermediate:</code></pre><h3>After Change</h3><pre><code class='java'>
        if self.return_intermediate:
            return torch.stack(intermediate)

        <a id="change">return </a>output


def _get_clones(module, N):</code></pre>