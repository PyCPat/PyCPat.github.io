<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        self.transformer = transformer
        self.position_embedding = position_embedding
        self.class_embed = nn.Linear(embed_dim, num_classes)
        self.bbox_embed<a id="change"> = </a><a id="change">MLP(</a>embed_dim, embed_dim, 4, 3<a id="change">)</a>
        self.refpoint_embed = nn.Embedding(num_queries, query_dim)
        self.num_classes = num_classes
        self.num_queries = num_queries
        self.criterion = criterion</code></pre><h3>After Change</h3><pre><code class='java'>

        &#47&#47 define classification head and box head
        self.class_embed = nn.Linear(embed_dim, num_classes)
        self.bbox_embed = <a id="change">MLP(
            input_dim=embed_dim, 
            hidden_dim=embed_dim, 
            output_dim=4, 
            num_layers=3
        )</a>
        self.num_classes = num_classes

        &#47&#47 predict offsets to update anchor boxes after each decoder layer
        &#47&#47 with shared box embedding head</code></pre>