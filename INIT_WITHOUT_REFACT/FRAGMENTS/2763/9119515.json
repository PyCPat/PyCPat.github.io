{"BEFORE":"        sq = q_r[:, :, 0]\n        sk = k_r.sum(dim=2)\n        sk = F.pad(sk, (0, 0, 1, 0))\n\n        R = torch.einsum('bie,bje->bij', sq, sk)\n","AFTER":"        sq = q_r[:, :, 0]\n        sk = k_r.sum(dim=2)\n        sk = F.pad(sk, (0, 0, 1, 0))\n\n        R = torch.einsum('bie,bje->bij', sq, sk) * (dim ** -0.5)\n"}