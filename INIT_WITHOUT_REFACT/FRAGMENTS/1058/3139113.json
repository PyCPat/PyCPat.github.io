{"BEFORE":"            input = input.unsqueeze(0).repeat(self.ensemble_size)\n        out = self.linear(input.permute(1, 0, 2).reshape(-1, self.in_features*self.ensemble_size))\n        return out.reshape(-1, self.ensemble_size, self.out_features).permute(1, 0, 2)\n","AFTER":"            return torch.einsum('ij,bjk->bik', input, self.weight) + self.bias\n        else:\n            return torch.einsum('bij,bjk->bik', input, self.weight) + self.bias\n"}