{"BEFORE":"        longi_mean = self.data_feature.get(\"longi_mean\", 104.05810954320589)\n        longi_std = self.data_feature.get(\"longi_std\", 0.04988770679679998)\n        current_longi = (batch[\"current_longi\"] - longi_mean) \/ longi_std\n        lngs = torch.unsqueeze(current_longi, dim=2)\n        lati_mean = self.data_feature.get(\"lati_mean\", 30.652312982784895)\n        lati_std = self.data_feature.get(\"lati_std\", 0.04988770679679998)\n        current_lati = (batch['current_lati'] - lati_mean) \/ lati_std\n        lats = torch.unsqueeze(current_lati, dim=2)\n\n        states = self.state_em(batch['current_state'].long())\n\n        locs = torch.cat((lngs, lats, states), dim=2)\n\n        # map the coords into 16-dim vector\n        locs = torch.tanh(self.process_coords(locs))\n        locs = locs.permute(0, 2, 1)\n\n        conv_locs = F.elu(self.conv(locs)).permute(0, 2, 1)\n\n        dist_gap_mean = self.data_feature.get(\"dist_gap_mean\", 0.274716042312)\n        dist_gap_std = self.data_feature.get(\"dist_gap_std\", 0.127051674693)\n        current_dis = (batch[\"current_dis\"] - dist_gap_mean) \/ dist_gap_std\n","AFTER":"        longi_mean, longi_std = self.data_feature[\"longi_mean\"], self.data_feature[\"longi_std\"]\n        current_longi = normalize(batch[\"current_longi\"], longi_mean, longi_std)\n        lngs = torch.unsqueeze(current_longi, dim=2)\n        lati_mean, lati_std = self.data_feature[\"lati_mean\"], self.data_feature[\"lati_std\"]\n        current_lati = normalize(batch[\"current_lati\"], lati_mean, lati_std)\n        lats = torch.unsqueeze(current_lati, dim=2)\n\n        states = self.state_em(batch['current_state'].long())\n\n        locs = torch.cat((lngs, lats, states), dim=2)\n\n        # map the coords into 16-dim vector\n        locs = torch.tanh(self.process_coords(locs))\n        locs = locs.permute(0, 2, 1)\n\n        conv_locs = F.elu(self.conv(locs)).permute(0, 2, 1)\n\n        dist_gap_mean, dist_gap_std = self.data_feature[\"dist_gap_mean\"], self.data_feature[\"dist_gap_std\"]\n        current_dis = normalize(batch[\"current_dis\"], dist_gap_mean, dist_gap_std)\n"}