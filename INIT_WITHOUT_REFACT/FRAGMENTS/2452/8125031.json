{"BEFORE":"        neg = self.tokens.sample(batchsize, self.neg_sample_num).to(device)\n        pred = torch.bmm(self.embeddings_r(torch.cat([pos, neg], dim=1)), v).squeeze()\n        label = torch.cat([torch.ones(batchsize, 3), torch.zeros(batchsize, self.neg_sample_num)], dim=1).to(device)\n","AFTER":"    def forward(self, inp, pos, neg):\n        device, batch_size = inp.device, inp.shape[0]\n        v = self.v(inp)\n        # negative sampling loss\n        pred = torch.bmm(self.embeddings_r(torch.cat([pos, neg], dim=1)), v).squeeze()\n        label = torch.cat([torch.ones(batch_size, 3), torch.zeros(batch_size, neg.shape[1])], dim=1).to(device)\n"}