{"BEFORE":"        layers = nn.ModuleList([])\n        for _ in range(depth):\n            layers.append(nn.ModuleList([\n                SinkhornSelfAttention(dim, causal = causal, heads = heads, buckets = buckets, sinkhorn_iter = sinkhorn_iter, n_sortcut = n_sortcut, temperature = temperature),\n                Chunk(ff_chunks, FeedForward(dim), along_dim=1)\n            ]))\n","AFTER":"        layers = nn.ModuleList([])\n        for _ in range(depth):\n            layers.append(nn.ModuleList([\n                WithNorm(nn.LayerNorm, dim, SinkhornSelfAttention(dim, causal = causal, heads = heads, buckets = buckets, sinkhorn_iter = sinkhorn_iter, n_sortcut = n_sortcut, temperature = temperature)),\n                Chunk(ff_chunks, WithNorm(nn.LayerNorm, dim, FeedForward(dim)), along_dim=1)\n            ]))\n"}