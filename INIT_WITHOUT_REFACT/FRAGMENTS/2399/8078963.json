{"BEFORE":"        if self.store_losses and self.istft is not None:\n            enhanced_td = self.istft(enhanced)\n            clean_td = self.istft(clean)\n            self.store_summaries(enhanced_td, clean_td, snrs, ml, sl, cal)\n        return ml + sl + cal\n","AFTER":"        enhanced_td = None\n        clean_td = None\n        if self.istft is not None:\n            if self.store_losses or self.mrsl is not None:\n                enhanced_td = self.istft(enhanced)\n                clean_td = self.istft(clean)\n\n        ml, sl, mrsl, cal = [torch.zeros((), device=clean.device)] * 4\n        if self.ml_f != 0 and self.ml is not None:\n            ml = self.ml(input=mask, clean=clean, noisy=noisy, max_bin=max_bin)\n        if self.sl_f != 0 and self.sl is not None:\n            sl = self.sl(input=enhanced, target=clean)\n        if self.mrsl_f > 0 and self.mrsl is not None:\n            mrsl = self.mrsl(enhanced_td, clean_td)\n        if self.cal_f != 0 and self.cal is not None:\n            lsnr_gt = self.lsnr(clean, noise=noisy - clean, max_bin=self.nb_df)\n            cal = self.cal(df_alpha, target_lsnr=lsnr_gt)\n        if self.store_losses and self.istft is not None:\n            self.store_summaries(enhanced_td, clean_td, snrs, ml, sl, cal)  # type: ignore\n        return ml + sl + cal\n"}