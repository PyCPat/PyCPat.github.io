{"BEFORE":"        pos_enc = torch.outer(pos, self.inv_freq)\n        return torch.cat((pos_enc, pos_enc), dim=-1)\n","AFTER":"        pos_enc = torch.einsum(\"p, f -> p f\", pos, self.inv_freq)\n        # for a single position p: [pf_1, pf_2, ..., pf_dim\/2] -> [pf_1, pf1, pf_2, pf_2..., pf_dim\/2, pf_dim\/2]\n        pos_enc = repeat(pos_enc, \"... pf -> ... (pf r)\", r=2)\n        # pos_enc.shape == (seq_len, dim)\n        return pos_enc\n"}