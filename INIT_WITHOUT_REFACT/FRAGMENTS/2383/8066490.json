{"BEFORE":"        q = q * self.scale\n        v = self.v(x).reshape(B, N, self.num_heads, C \/\/ self.num_heads).permute(0, 2, 1, 3)\n\n        attn = (q @ k.transpose(-2, -1))\n        attn = attn.softmax(dim=-1)\n        attn = self.attn_drop(attn)\n\n        x_cls = (attn @ v).transpose(1, 2).reshape(B, 1, C)\n","AFTER":"        q = q * self.scale\n        v = self.v(x).reshape(B, N, self.num_heads, C \/\/ self.num_heads).permute(0, 2, 1, 3)\n\n        attn = torch.matmul(q, k.transpose(-2, -1))\n        attn = attn.softmax(dim=-1)\n        attn = self.attn_drop(attn)\n\n        x_cls = torch.matmul(attn, v).transpose(1, 2).reshape(B, 1, C)\n"}