{"BEFORE":"        return x\n","AFTER":"        extero,\n        privileged\n    ):\n        check_shape(proprio, 'b d', d = self.proprio_dim)\n        check_shape(extero, 'b n d', n = self.num_legs, d = self.extero_dim)\n        check_shape(privileged, 'b d', d = self.privileged_dim)\n\n        latent_extero = self.extero_encoder(extero)\n        latent_privileged = self.privileged_encoder(privileged)\n\n        latent = torch.cat((\n            proprio,\n            rearrange(latent_extero, 'b ... -> b (...)'),\n            latent_privileged,\n        ), dim = -1)\n\n        return self.to_actions_logits(latent)\n"}