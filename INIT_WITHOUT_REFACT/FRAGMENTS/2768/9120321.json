{"BEFORE":"        x, gate = x.chunk(2, dim = -1)\n        gate = self.norm(gate)\n        return self.proj(gate) * x\n","AFTER":"        res, gate = x.chunk(2, dim = -1)\n        gate = self.norm(gate)\n        gate = self.proj(gate)\n        if exists(self.attn):\n            gate += self.attn(x)\n        return gate * res\n"}