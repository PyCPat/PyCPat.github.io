{"BEFORE":"        KW = torch.einsum(\"nk,bnc->bkc\", E, KW)\n        QW = self.w_q(Q)\n        QW = torch.einsum(\"bnc,bkc->bnk\", QW, KW)\n        P_bar = QW\/torch.sqrt(torch.tensor(self.dim, dtype=torch.float32))\n        P_bar = P_bar.softmax(dim=-1)\n        P_bar = self.dropout(P_bar)\n\n        VW = self.w_v(V)\n        VW = torch.einsum(\"nk,bnc->bkc\", F, VW)\n        out_tensor = torch.einsum(\"bnk,bkc->bnc\", P_bar, VW)\n","AFTER":"        KW = torch.matmul(E, KW)\n        KW = torch.transpose(KW, 1, 2)\n        QW = self.w_q(Q)\n        QW = torch.matmul(QW, KW)\n\n        # TODO: Possibly change the dtype?\n        P_bar = QW\/torch.sqrt(torch.tensor(self.dim, dtype=torch.float32))\n        P_bar = P_bar.softmax(dim=-1)\n        P_bar = self.dropout(P_bar)\n\n        VW = self.w_v(V)\n        VW = torch.matmul(F, VW)\n        out_tensor = torch.matmul(P_bar, VW)\n"}