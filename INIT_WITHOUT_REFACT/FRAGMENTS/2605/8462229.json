{"BEFORE":"        pad = partial(pad_sequence, batch_first = True, padding_value = self.pad_value)\n\n        xi = x[:, :-1]\n        xo = x[:, 1:]\n\n        # help auto-solve a frequent area of confusion around input masks in auto-regressive\n        # if user supplies a mask that is only off by one from the source sequence, resolve it for them\n        mask = kwargs.pop('mask', None)\n        if mask is not None and mask.shape[1] == x.shape[1]:\n            mask = mask[:, :-1]\n            kwargs.update(mask = mask)\n","AFTER":"        mask = kwargs.get('mask', None)\n        if mask is not None and mask.shape[1] == x.shape[1]:\n            mask = mask[:, :-1]\n            kwargs['mask'] = mask\n"}