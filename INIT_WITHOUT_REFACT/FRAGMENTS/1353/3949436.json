{"BEFORE":"        batch_size, height, width, sums, repetitions = x.size()\n        assert width == 1\n        assert height == 1\n        assert sums == self.config.num_classes\n\n        # Apply C sum node outputs\n        x = self.root(x)\n\n        # Remove height\/width dimension\n        x = x.squeeze(1).squeeze(1)\n\n        # Final shape check\n        assert x.shape == (batch_size, self.config.num_classes)\n","AFTER":"        x = self._forward_layers(x)\n\n        # Merge results from the different repetitions into the channel dimension\n        batch_size, features, channels, repetitions = x.size()\n        assert features == 1  # number of features should be 1 at this point\n        assert channels == self.config.C\n\n        # Treat repetitions as additional channels at this point\n        x = x.reshape(batch_size, 1, channels * repetitions, 1)\n\n        # Apply C sum node outputs\n        x = self.root(x)\n\n        # Remove repetition dimension\n        x = x.squeeze(3)\n\n        # Remove in_features dimension\n        x = x.squeeze(1)\n"}