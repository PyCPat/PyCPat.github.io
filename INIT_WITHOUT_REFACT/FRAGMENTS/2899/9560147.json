{"BEFORE":"        return x\n","AFTER":"        if x.ndim == 2:\n            x = rearrange(x, 'b n -> b 1 n')\n\n        orig_x = x.clone()\n\n        x = self.encoder(x)\n\n        x = rearrange(x, 'b c n -> b n c')\n        x, indices, commit_loss = self.rq(x)\n        x = rearrange(x, 'b n c -> b c n')\n\n        recon_x = self.decoder(x)\n\n        recon_loss = F.mse_loss(orig_x, recon_x)\n        return recon_loss\n"}