{"BEFORE":"        self.rank = rank\n\n        if len(empty_idx) == 0:\n            empty_idx = [self.rank + 1]  # jit doesn't seem to like empty lists\n        self.empty_idx = empty_idx\n\n        self.param_rank = len([i for i in range(self.rank) if i not in self.empty_idx])\n","AFTER":"        self.rank = rank\n\n        empty_idx = set(empty_idx)\n        assert all(isinstance(x, int) for x in empty_idx)\n        self.param_rank = self.rank - len(empty_idx)\n        mask = torch.zeros((self.rank, self.param_rank))\n        c = 0\n        for r in range(self.rank):\n            if r not in empty_idx:\n                mask[r, c] = 1.\n                c += 1\n        self.register_buffer('mask', mask)\n"}