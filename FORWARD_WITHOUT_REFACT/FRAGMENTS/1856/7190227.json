{"BEFORE":"        x =  torch.cat((cls_token, tokens), dim = 1)\n        x += self.pos_emb(torch.arange(x.shape[1], device = device))\n\n        for (time_attn, spatial_attn, ff) in self.layers:\n            x = time_attn(x, 'b (f n) d', '(b n) f d', n = n)\n            x = spatial_attn(x, 'b (f n) d', '(b f) n d', f = f)\n            x = ff(x)\n","AFTER":"        x =  torch.cat((cls_token, tokens), dim = 1)\n        x += self.pos_emb(torch.arange(x.shape[1], device = device))\n\n        for (time_attn, spatial_attn, ff) in self.layers:\n            x = time_attn(x, 'b (f n) d', '(b n) f d', n = n) + x\n            x = spatial_attn(x, 'b (f n) d', '(b f) n d', f = f) + x\n            x = ff(x) + x\n"}