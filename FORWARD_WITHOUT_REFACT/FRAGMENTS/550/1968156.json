{"BEFORE":"    def forward(self, x, attn_mask=None):\n        B, N, C = x.shape\n        qkv = self.qkv(x).reshape(B, N, 3, self.num_heads, C \/\/ self.num_heads)\n        q, k, v = qkv[:, :, 0].transpose(1, 2), qkv[:, :, 1].transpose(1, 2), qkv[:, :, 2].transpose(1, 2)\n","AFTER":"        q, k, v = self.qkv(x).reshape(B, N, 3, self.num_heads, C \/\/ self.num_heads).permute(2, 0, 3, 1, 4)\n"}