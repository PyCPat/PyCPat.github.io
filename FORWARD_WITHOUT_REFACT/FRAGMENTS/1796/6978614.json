{"BEFORE":"        sinusoid_inp = einsum('i , j -> i j', t, self.inv_freq)\n        emb = torch.cat((sinusoid_inp.sin(), sinusoid_inp.cos()), dim=-1)\n        return rearrange(emb, 'i j -> () i j')\n","AFTER":"        freqs = einsum('i , j -> i j', seq, self.inv_freq)\n        freqs = repeat(freqs, 'i j -> () i (j r)', r = 2)\n        return [freqs.sin(), freqs.cos()]\n"}