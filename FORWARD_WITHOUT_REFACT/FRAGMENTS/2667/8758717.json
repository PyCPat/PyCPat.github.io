{"BEFORE":"        q, k, v = self.to_qkv(x).chunk(3, dim = 1)\n","AFTER":"    def forward(self, x, mask = None, context = None):\n        n, device, h, g, causal = x.shape[2], x.device, self.heads, self.groups, self.causal\n        context = default(context, x)\n\n        q, k, v = (self.to_q(x), *self.to_kv(context).chunk(2, dim = 1))\n"}