{"BEFORE":"            y = torch.diag(torch.ones(N-abs(d)), diagonal=d) # (N, N)\n","AFTER":"        x = x.view(B, N, -1) # (B, N, n_hidden)\n        w = self.context \/\/ 2\n        z = []\n        for d in range(-w, w+1):\n            y = torch.diag(torch.ones(N-abs(d)), diagonal=d).to(x.device) # (N, N)\n"}