<link rel="stylesheet" href="../default.css">
<script src="../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            pd = torch.det(Aup) * torch.det(Adown)
            out *= pd

        return -0.5*<a id="change">out.view(-1</a>, self.nconfs<a id="change">)</a>

    def _forward_loop(self, MO, d2MO, return_local_energy=False):
        &quot&quot&quot Compute the kinetic energy using the trace trick
        for a product of spin up/down determinant</code></pre><h3>After Change</h3><pre><code class='java'>

        &#47&#47 product
        out = (btrace(iAup@Bup) + btrace(iAdown@Bdown))
        <a id="change">print(</a>out.shape<a id="change">)</a>

        &#47&#47 multiply by det if necessary
        if not return_local_energy:
            pd = torch.det(Aup) * torch.det(Adown)</code></pre>