{"BEFORE":"        x = x.view(new_shape)\n        # The better way, but not supported by torchscript\n        # x = x.unflatten(-1, (self.groups, self.ws))  # [..., G, I\/G]\n        x = torch.einsum(\"...gi,...gih->...gh\", x, self.weight)  # [..., G, H\/G]\n","AFTER":"        x = x.view(new_shape)\n        # The better way, but not supported by torchscript\n        #     x = x.unflatten(-1, (self.groups, self.ws))  # [..., G, I\/G]\n        # This is also not supported by tract:\n        #     x = torch.einsum(\"btgi,gih->btgh\", x, self.weight)  # [..., G, H\/G]\n        # Thus, lets to some manual reshaping and multiplication:\n        x = x.unsqueeze(-1).mul(self.weight.unsqueeze(0).unsqueeze(0)).sum(-2)\n"}