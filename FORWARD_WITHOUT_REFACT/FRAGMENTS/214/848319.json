{"BEFORE":"        XY = X * Y\n\n        # add the components if DZ basis set\n        if self.basis == 'dz':\n            nrbf = XY.shape[-1]\n            norb = int(nrbf\/2)\n            XY = 0.5*XY.view(-1,self.nelec,2,norb).sum(2)\n","AFTER":"        XY = X * Y\n\n        # add the components if DZ basis set\n        # if self.basis == 'dz':\n        #     nrbf = XY.shape[-1]\n        #     norb = int(nrbf\/2)\n        #     XY = 0.5*XY.view(-1,self.nelec,2,norb).sum(2)\n\n        # contract the basis\n        if self.basis != 'sz':\n                nbatch = XY.shape[0]\n                XYtmp = torch.zeros(nbatch,self.nelec,self.norb)\n                print(XYtmp.shape)\n                print(XY.shape)\n                print(self.index_ctr)\n                XYtmp.index_add_(2,self.index_ctr,XY)\n"}