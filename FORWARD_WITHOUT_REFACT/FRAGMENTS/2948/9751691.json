{"BEFORE":"        for (layer_type, (norm, block)) in zip(self.layer_types, self.layers):\n            if self.pre_norm:\n                x = norm(x)\n\n            if layer_type == 'a':\n                attn_out, pre_attn = block(x, mask = mask, rel_pos = self.rel_pos, prev_attn = prev_attn)\n                x = x + attn_out\n            elif layer_type == 'c':\n                attn_out, pre_attn = block(x, context = context, mask = mask, context_mask = context_mask, prev_attn = prev_attn) + x\n                x = x + attn_out\n            elif layer_type == 'f':\n                x = block(x) + x\n\n            if isinstance(block, Attention) and self.residual_attn:\n                prev_attn = pre_attn\n\n            if not self.pre_norm:\n","AFTER":"        for ind, (layer_type, (norm, block)) in enumerate(zip(self.layer_types, self.layers)):\n            is_last = ind == (len(self.layers) - 1)\n\n            if self.pre_norm:\n                x = norm(x)\n\n            if layer_type == 'a':\n                out, pre_attn = block(x, mask = mask, rel_pos = self.rel_pos, prev_attn = prev_attn)\n            elif layer_type == 'c':\n                out, pre_attn = block(x, context = context, mask = mask, context_mask = context_mask, prev_attn = prev_attn)\n            elif layer_type == 'f':\n                out = block(x)\n\n            x = x + out\n\n            if isinstance(block, Attention) and self.residual_attn:\n                prev_attn = pre_attn\n\n            if not self.pre_norm and not is_last:\n"}