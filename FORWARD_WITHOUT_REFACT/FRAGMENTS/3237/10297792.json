{"BEFORE":"        pair_emb = tf_emb_i[..., None, :] + tf_emb_j[..., None, :, :]\n        pair_emb += self.relpos(ri)\n        #pair_emb = pair_emb + self.relpos(ri)\n\n        # [*, N_clust, N_res, c_m]\n        n_clust = msa.shape[-3]\n        tf_m = (self.linear_tf_m(tf)\n                .unsqueeze(-3)\n                .expand((*(-1,) * len(tf.shape[:-2]), n_clust, -1, -1)))\n","AFTER":"        pair_emb = tf_emb_i[..., None, :] + tf_emb_j[..., None, :, :]\n        pair_emb = pair_emb + self.relpos(ri.type(pair_emb.dtype))\n\n        # [*, N_clust, N_res, c_m]\n        n_clust = msa.shape[-3]\n        tf_m = (\n            self.linear_tf_m(tf)\n            .unsqueeze(-3)\n            .expand(((-1,) * len(tf.shape[:-2]) + (n_clust, -1, -1)))\n"}