{"BEFORE":"        mag = torch.sqrt(torch.sum(label ** 2, dim=1))\n\n        # Temp Fix\n        valid = (label[:, 0].abs() < 1000) & (label[:, 1].abs() < 1000)\n        valid = valid.float()\n","AFTER":"        assert (\n            label.shape[1] == 3\n        ), \"Incorrect channel dimension. Set append valid mask to True in DataloaderCreator to append the valid data mask in the target label.\"\n\n        n_preds = len(pred)\n        flow_loss = 0.0\n\n        flow, valid = label[:, :2, :, :], label[:, 2:, :, :]\n        valid = torch.squeeze(valid, dim=1)\n\n        mag = torch.sqrt(torch.sum(flow ** 2, dim=1))\n"}