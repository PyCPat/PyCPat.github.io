{"BEFORE":"        out = torch.zeros(input.shape[0],self.nconfs)\n        for isample in range(input.shape[0]):\n\n            for ic,(cup,cdown) in enumerate(zip(self.configs[0],self.configs[1])):\n\n                mo_up = input[isample].index_select(0,self.index_up).index_select(1,cup)\n                mo_down = input[isample].index_select(0,self.index_down).index_select(1,cdown)\n                out[isample,ic] = torch.det(mo_up) * torch.det(mo_down)\n\n        return out\n","AFTER":"        nbatch = input.shape[0]\n        out = torch.zeros(nbatch,self.nconfs)\n        \n        for ic,(cup,cdown) in enumerate(zip(self.configs[0],self.configs[1])):\n\n            mo_up = input.index_select(1,self.index_up).index_select(2,cup)\n            mo_down = input.index_select(1,self.index_down).index_select(2,cdown)\n\n            # a batch version of det is on its way (end July 2019)\n            # https:\/\/github.com\/pytorch\/pytorch\/issues\/7500\n            # we'll move to that asap but in the mean time we loop\n            for isample in range(nbatch):\n                out[isample,ic] = torch.det(mo_up[isample]) * torch.det(mo_down[isample])\n\n        return out\n"}