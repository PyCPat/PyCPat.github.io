{"BEFORE":"        B, C = x.shape[:2]\n        ori_shape = x.shape\n        x = x.transpose(-1, 1).reshape(B, -1, 3, C)\n        x = self.ln(x)\n        x = x.transpose(-1, 1).reshape(ori_shape)\n","AFTER":"        norm = torch.norm(x, dim=2) + EPS  # [B, C, N, ...]\n        norm_ln = self.ln(norm.transpose(1, -1)).transpose(1, -1)\n        norm = norm.unsqueeze(2)\n        norm_ln = norm_ln.unsqueeze(2)\n        x = x \/ norm * norm_ln\n"}