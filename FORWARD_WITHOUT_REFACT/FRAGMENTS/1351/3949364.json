{"BEFORE":"            c = c @ F.one_hot(idx, num_classes=RWKV_CFG.vocab_size).float()\n","AFTER":"            c = c.masked_fill(self.copy_mask[:T, :T] == 0, 0)\n\n            if '32' in os.environ['RWKV_FLOAT_MODE']:\n                c = c @ F.one_hot(idx, num_classes=RWKV_CFG.vocab_size)\n            elif os.environ['RWKV_FLOAT_MODE'] == 'fp16':\n                c = c @ F.one_hot(idx, num_classes=RWKV_CFG.vocab_size).half()\n            elif os.environ['RWKV_FLOAT_MODE'] == 'bf16':\n                c = c @ F.one_hot(idx, num_classes=RWKV_CFG.vocab_size).bfloat16()\n\n            x = self.head(x) + c\n"}