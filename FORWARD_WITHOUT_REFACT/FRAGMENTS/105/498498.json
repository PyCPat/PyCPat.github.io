{"BEFORE":"        edge_out = self.sigmoid(cs)\n        cat = torch.cat((edge_out, canny), dim=1)\n        acts = self.cw(cat)\n        acts = self.sigmoid(acts)\n\n        # aspp\n        x = self.aspp(m7, acts)\n        dec0_up = self.bot_aspp(x)\n\n        dec0_fine = self.bot_fine(m2)\n        dec0_up = self.interpolate(dec0_up, m2.size()[2:], mode='bilinear', align_corners=True)\n        dec0 = [dec0_fine, dec0_up]\n        dec0 = torch.cat(dec0, 1)\n\n        dec1 = self.final_seg(dec0)\n        seg_out = self.interpolate(dec1, x_size[2:], mode='bilinear')\n\n        if self.training:\n            return self.criterion((seg_out, edge_out), gts)\n        else:\n            return seg_out, edge_out\n","AFTER":"        seg_out = self.interpolate(dec1, x_size[2:], mode='bilinear')\n\n        return seg_out\n"}