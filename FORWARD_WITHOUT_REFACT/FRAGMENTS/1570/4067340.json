{"BEFORE":"        kv_heads = 1 if one_kv_head else heads\n","AFTER":"        self.global_attn_heads = heads - n_local_attn_heads\n        self.global_attn_fn = linear_attn if not causal else partial(causal_linear_attn, psi=psi_fn, bucket_size = blindspot_size)\n\n        self.local_attn_heads = n_local_attn_heads\n        self.local_attn  = LocalAttention(local_attn_window_size, n_local_attn_heads, d_heads, causal = causal, dropout = attn_dropout)\n\n        self.to_q = nn.Linear(dim, dim, bias = False)\n\n        kv_heads = (int(self.local_attn_heads > 0) + int(self.global_attn_heads > 0)) if one_kv_head else heads\n"}