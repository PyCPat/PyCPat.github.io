{"BEFORE":"        norm_diff = torch.pow((d_norm - p_norm), 2)\n        res = torch.sum(weight.unsqueeze(-1) * norm_diff)\n        return res \/ weight.numel() if self.size_average == True else res\n","AFTER":"        dot_diff = 1. - torch.sum(d_norm * p_norm, dim = -1)\n        # norm_diff = torch.pow((d_norm - p_norm), 2)\n        return torch.mean(weight * dot_diff) if self.size_average == True else torch.sum(weight * dot_diff)\n"}