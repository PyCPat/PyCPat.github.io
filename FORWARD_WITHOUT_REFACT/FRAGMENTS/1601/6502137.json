{"BEFORE":"        output = {}\n        x = input['img']\n        out = self.conv1(x)\n        out = self.layer1(out)\n        out = self.layer2(out)\n        out = self.layer3(out)\n        out = self.layer4(out)\n        out = F.relu(self.n4(self.scaler(out)))\n        out = F.adaptive_avg_pool2d(out, 1)\n        out = out.view(out.size(0), -1)\n        out = self.linear(out)\n        if 'label_split' in input and cfg['mask']:\n            label_mask = torch.zeros(cfg['classes_size'], device=out.device)\n            label_mask[input['label_split']] = 1\n            out = out.masked_fill(label_mask == 0, 0)\n        output['score'] = out\n        output['loss'] = F.cross_entropy(output['score'], input['label'])\n        return output\n","AFTER":"        out = self.linear(out)\n        return out\n"}