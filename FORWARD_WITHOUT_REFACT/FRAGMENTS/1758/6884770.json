{"BEFORE":"        raise NotImplementedError()\n","AFTER":"        n = len(features)\n        parent_indices = parent_flow_dict.activated.argsort(dim=1)[:, :self.top_k]\n        res = []\n        for i in range(n):\n            res_for_parent = []\n            for parent_index in parent_indices[i]:\n                res_for_parent.append(self.fcs[parent_index](features[i:i+1]))\n            res.append(res_for_parent)\n        return res\n"}