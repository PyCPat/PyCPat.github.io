{"BEFORE":"        B, H, W, C = x.shape\n        N = H * W\n        num_tokens = int(self.kernel_size ** 2)\n        pad_l = pad_t = pad_r = pad_b = 0\n        Ho, Wo = H, W\n        if N <= num_tokens:\n            if self.kernel_size > W:\n                pad_r = self.kernel_size - W\n            if self.kernel_size > H:\n                pad_b = self.kernel_size - H\n            x = pad(x, (0, 0, pad_l, pad_r, pad_t, pad_b))\n            B, H, W, C = x.shape\n            N = H * W\n            assert N == num_tokens, f\"Something went wrong. {N} should equal {H} x {W}!\"\n","AFTER":"        B, Hp, Wp, C = x.shape\n        H, W = Hp, Wp\n        pad_l = pad_t = pad_r = pad_b = 0\n        if H < self.kernel_size or W < self.kernel_size:\n            pad_l = pad_t = 0\n            pad_r = max(0, self.window_size - W)\n            pad_b = max(0, self.window_size - H)\n            x = pad(x, (0, 0, pad_l, pad_r, pad_t, pad_b))\n            _, H, W, _ = x.shape\n"}