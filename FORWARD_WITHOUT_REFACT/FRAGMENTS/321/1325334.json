{"BEFORE":"        q *= self.scale\n        attn = q.transpose(-2, -1) @ k\n        attn = attn.softmax(dim=-1)\n\n        out = (v @ attn).reshape(b, -1, h, w)\n","AFTER":"        attn = q.transpose(-2, -1) @ k * self.scale\n        attn = attn.softmax(dim=-1)\n\n        out = (v @ attn.transpose(-2, -1)).reshape(b, -1, h, w)\n"}