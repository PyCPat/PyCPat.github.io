{"BEFORE":"        key = self.k_lin(x)\n        value = self.v_lin(x)\n        print(\"shape of key: {};\".format(key.shape))\n        scores = torch.bmm(query, key.transpose(1, 2))\n        attention_weights = self.masked_softmax(scores, valid_len)\n        return torch.bmm(attention_weights, value)\n","AFTER":"        value = self.v_lin(x)\n        # print(\"shape of key: {};\".format(key.shape))\n        scores = torch.bmm(query, key.transpose(1, 2))\n        attention_weights = self.masked_softmax(scores, valid_len)\n        x = torch.bmm(attention_weights, value).reshape(-1, self.in_channels)\n        return x\n"}