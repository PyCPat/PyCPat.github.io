{"BEFORE":"        i_pos = torch.arange(wsz, device = device)\n        j_pos = torch.arange(wsz, device = device)\n        grid = torch.stack(torch.meshgrid(i_pos, j_pos))\n        grid = rearrange(grid, 'c i j -> (i j) c')\n        rel_ij = grid[:, None] - grid[None, :]\n        rel_pos_bias = self.dpb(rel_ij.float())\n","AFTER":"        pos = torch.arange(-wsz, wsz + 1, device = device)\n        rel_pos = torch.stack(torch.meshgrid(pos, pos))\n        rel_pos = rearrange(rel_pos, 'c i j -> (i j) c')\n        biases = self.dpb(rel_pos.float())\n        rel_pos_bias = biases[self.rel_pos_indices]\n"}