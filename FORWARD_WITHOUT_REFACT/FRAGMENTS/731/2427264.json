{"BEFORE":"        items_embedding = self.item_embedding(torch.tensor([i for i in range(self.items_total)]).to(nodes_output.device))\n        alpha = torch.sigmoid(self.alpha)\n        embed = (1 - alpha) * items_embedding.clone() + alpha * nodes_output\n        return embed\n","AFTER":"        batch_size = nodes_output.shape[0] \/\/ self.items_total\n        id = 0\n        num_nodes = self.items_total\n        items_embedding = self.item_embedding(torch.tensor([i for i in range(self.items_total)]).to(nodes_output.device))\n        batch_embedding = []\n        for _ in range(batch_size):\n            output_node_features = nodes_output[id:id + num_nodes, :]\n            embed = (1 - self.alpha) * items_embedding\n\n            embed = embed + self.alpha * output_node_features\n            batch_embedding.append(embed)\n            id += num_nodes\n        batch_embedding = torch.stack(batch_embedding)\n        return batch_embedding\n"}