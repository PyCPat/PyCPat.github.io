{"BEFORE":"        B, N, C = x.shape\n\n        x_l = x.view(B, N, 1, C).expand(B, N, N, C)\n        x_r = x.view(B, 1, N, C).expand(B, N, N, C)\n","AFTER":"    def forward(self, x_l, x_r=None):\n        x_r = x_l if x_r is None else x_r\n        assert(x_l.shape == x_r.shape)\n        B, N, C = x_l.shape\n\n        x_l = x_l.view(B, N, 1, C).expand(B, N, N, C)\n        x_r = x_r.view(B, 1, N, C).expand(B, N, N, C)\n"}