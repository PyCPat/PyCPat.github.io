{"BEFORE":"\tdef forward(self, input_ids=None, attention_mask=None, token_type_ids=None, position_ids=None, head_mask=None, inputs_embeds=None, labels=None):\n\t\tout_wiki = self.bert_wiki(\n\t\t\tinput_ids \t= input_ids,\n\t\t\tattention_mask\t= attention_mask,\n\t\t\ttoken_type_ids\t= token_type_ids,\n\t\t\tposition_ids\t= position_ids,\n\t\t\thead_mask\t= head_mask,\n\t\t\tinputs_embeds\t= inputs_embeds,\n\t\t)\n\n\t\tpooled_wiki = out_wiki[1]\n\n\t\tout_pubmed = self.bert_pubmed(\n\t\t\tinput_ids \t= input_ids,\n\t\t\tattention_mask\t= attention_mask,\n\t\t\ttoken_type_ids\t= token_type_ids,\n\t\t\tposition_ids\t= position_ids,\n\t\t\thead_mask\t= head_mask,\n\t\t\tinputs_embeds\t= inputs_embeds,\n\t\t)\n\n\t\tpooled_pubmed   = out_pubmed[1]\n","AFTER":"\tdef forward(self, input_ids, attention_mask, mention_pos_idx, labels=None):\n\t\tout_wiki = self.bert_wiki(\n\t\t\tinput_ids \t= input_ids,\n\t\t\tattention_mask\t= attention_mask\n\t\t)\n\n\t\tout_pubmed = self.bert_pubmed(\n\t\t\tinput_ids \t= input_ids,\n\t\t\tattention_mask\t= attention_mask\n\t\t)\n\n\t\ttok_embed\t= out_wiki[0]\n\t\tbsz, mtok, dim  = tok_embed.shape\n\t\ttok_embed_flat\t= tok_embed.reshape(-1, dim)\n\t\tmen_idx \t= torch.arange(bsz).to(tok_embed.device) * mtok + mention_pos_idx\n\t\twiki_embed \t= tok_embed_flat[men_idx]\n\n\t\ttok_embed\t= out_pubmed[0]\n\t\tbsz, mtok, dim  = tok_embed.shape\n\t\ttok_embed_flat\t= tok_embed.reshape(-1, dim)\n\t\tmen_idx \t= torch.arange(bsz).to(tok_embed.device) * mtok + mention_pos_idx\n\t\tpubmed_embed \t= tok_embed_flat[men_idx]\n"}