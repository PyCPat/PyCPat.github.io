{"BEFORE":"\t\tdec_input = self.dec_input.unsqueeze(0).repeat(batch,1).unsqueeze(1).to(device)\n\t\tfor i in range(city_t):\n\t\t\t_, (h, c) = self.Decoder(dec_input, (h, c))\n\t\t\tquery, ref = h.squeeze(0), enc_h\n","AFTER":"\t\tembed_enc_inputs = self.Embedding(x)\n\t\tembed = embed_enc_inputs.size(2)\n\t\tenc_h, (h, c) = self.Encoder(embed_enc_inputs, None)\n\t\tref = enc_h\n\t\tquery = h.permute(1,0,2).to(device)# query = self.dec_input.unsqueeze(0).repeat(batch,1).unsqueeze(1).to(device)\n\t\tprocess_h, process_c = [torch.zeros((1, batch, embed), device = device) for _ in range(2)]\n\t\tfor i in range(self.n_process):\n\t\t\tquery, (process_h, process_c) = self.Decoder(query, (process_h, process_c))\n\t\t\tquery = query.squeeze(1)\n\t\t\tfor i in range(self.n_glimpse):\n\t\t\t\tquery = self.glimpse(query, ref)\n\t\t\t\tquery = query.unsqueeze(1)\n"}