{"BEFORE":"    def forward(self, x, y):\n        assert(x.size(0) == y.size(0))\n        batch_size = x.size(0)\n\n        out = self.conv_img(x)\n        out = self.resnet(out)\n        out = out.view(batch_size, self.nf0*self.s0*self.s0)\n        out = self.fc(actvn(out))\n\n        index = Variable(torch.LongTensor(range(out.size(0))))\n        if y.is_cuda:\n            index = index.cuda()\n        out = out[index, y]\n","AFTER":"        out = self.fc(actvn(out))\n\n        out = out.squeeze(1)\n        out = self.final_sigmoid(out)\n"}