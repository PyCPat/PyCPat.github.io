{"BEFORE":"        x = einsum('b n l d, l d e -> b n l e', levels, self.project_in)\n        x = self.nonlin(x)\n        x = einsum('b n l d, l d e -> b n l e', x, self.project_out)\n        return x\n","AFTER":"        b, n, l, d = levels.shape\n        levels = rearrange(levels, 'b n l d -> b (l d) n')\n        out = self.net(levels)\n        out = rearrange(out, 'b (l d) n -> b n l d', l = l)\n        return out\n"}