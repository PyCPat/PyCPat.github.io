{"BEFORE":"        pos_rels = batch_positives[:, 1:2]\n        pos_tails = batch_positives[:, 2:3]\n\n        neg_heads = batch_negatives[:, 0:1]\n        neg_rels = batch_negatives[:, 1:2]\n        neg_tails = batch_negatives[:, 2:3]\n\n        pos_head_embs = self.entity_embeddings(pos_heads)\n        pos_rel_embs = self.relation_embeddings(pos_rels)\n        pos_tail_embs = self.entity_embeddings(pos_tails)\n        pos_normal_embs = self.normal_vector_embeddings(pos_rels)\n\n        neg_head_embs = self.entity_embeddings(neg_heads)\n        neg_rel_embs = self.relation_embeddings(neg_rels)\n","AFTER":"        pos_rels = batch_positives[:, 1:2]\n        pos_tails = batch_positives[:, 2:3]\n\n        neg_heads = batch_negatives[:, 0:1]\n        neg_rels = batch_negatives[:, 1:2]\n        neg_tails = batch_negatives[:, 2:3]\n\n        # Shape: (batch_size, 1, embedding_dimension)\n        pos_head_embs = self.entity_embeddings(pos_heads)\n        # Reshape relation embeddings to the same shape of the projected entities\n        pos_rel_embs = self.relation_embeddings(pos_rels).view(-1, self.embedding_dim)\n        pos_tail_embs = self.entity_embeddings(pos_tails)\n        pos_normal_embs = self.normal_vector_embeddings(pos_rels)\n\n        neg_head_embs = self.entity_embeddings(neg_heads)\n        # Reshape relation embeddings to the same shape of the projected entities\n        neg_rel_embs = self.relation_embeddings(neg_rels).view(-1, self.embedding_dim)\n"}