{"BEFORE":"        num_pixels = n * h * w\n        bpp = -likelihoods.log2().sum() if self.reduction == 'sum' else -likelihoods.log2().sum() \/ num_pixels\n","AFTER":"        num_pixels = n * h * w\n        if self.reduction == 'sum':\n            bpp = -likelihoods.log2().sum()\n        elif self.reduction == 'batchmean':\n            bpp = -likelihoods.log2().sum() \/ n\n        else:\n            bpp = -likelihoods.log2().sum() \/ num_pixels\n        return reconstruction_loss + self.beta * bpp\n"}