{"BEFORE":"        pred_sigmoid = pred.sigmoid()\n        target = target.type_as(pred)\n        # focal_weight = (target - pred_sigmoid).abs().pow(self.gamma)\n        focal_weight = (\n            target * (target > 0.0).float()\n            + self.alpha\n            * (pred_sigmoid - target).abs().pow(self.gamma)\n            * (target == 0.0).float()\n        )\n        loss = (\n            F.binary_cross_entropy_with_logits(pred, target, reduction=\"none\")\n            * focal_weight\n        )\n","AFTER":"        pred_sigmoid = pred.sigmoid()\n        target = target.type_as(pred)\n        # focal_weight = (target - pred_sigmoid).abs().pow(self.gamma)\n        focal_weight = (\n            target * (target > 0.0).float()\n            + self.alpha * pred_sigmoid.pow(self.gamma) * (target == 0.0).float()\n        )\n        pt = (\n            pred_sigmoid * (target > 0.0).float()\n            + (1 - pred_sigmoid) * (target == 0.0).float()\n        )\n        loss = F.binary_cross_entropy_with_logits(\n            pred, target, reduction=\"none\"\n        ) * focal_weight + self.epsilon * (1 - pt).pow(self.gamma + 1)\n"}