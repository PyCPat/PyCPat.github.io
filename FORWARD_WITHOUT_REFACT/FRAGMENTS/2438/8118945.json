{"BEFORE":"        return image\n","AFTER":"        b, device, img_size, = image.shape[0], image.device, self.image_size\n        check_shape(image, 'b c h w', h = img_size, w = img_size, c = self.channels)\n\n        times = torch.randint(0, self.num_timesteps, (b,), device = device, dtype = torch.long)\n        image_embed = self.get_image_embed(image)\n\n        loss = self.p_losses(x, times, image_embed = image_embed, *args, **kwargs)\n        return loss\n"}