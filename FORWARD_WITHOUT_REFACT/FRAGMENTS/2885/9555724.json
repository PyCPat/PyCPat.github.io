{"BEFORE":"            k.masked_fill_(~mask, -torch.finfo(k.dtype).max)\n\n        q = q.softmax(dim = -1)\n        k = k.softmax(dim = -2)\n\n        q = q * self.scale\n\n        if exists(mask):\n            v.masked_fill_(~mask, 0.)\n","AFTER":"            k = k.masked_fill(~mask, -torch.finfo(k.dtype).max)\n\n        q = q.softmax(dim = -1)\n        k = k.softmax(dim = -2)\n\n        q = q * self.scale\n\n        if exists(mask):\n            v = v.masked_fill(~mask, 0.)\n"}