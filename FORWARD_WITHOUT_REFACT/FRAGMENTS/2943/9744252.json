{"BEFORE":"    def forward(self, codes):\n        # [n, c, h, w]\n        return self.decode(codes)\n","AFTER":"    def forward(self, codes: torch.Tensor) -> torch.Tensor:\n        # codes: [n, h, w, m]\n        n, h, w, _ = codes.shape\n        # use codes to index codebook (m, k, d) ==> [n, h, w, m, k] -> [n, c, h, w]\n        # ix = torch.arange(self._m, device=codes.device).expand_as(codes)\n        ix = self._ix.expand_as(codes)\n        return self._codebook[ix, codes].reshape(n, h, w, -1).permute(0, 3, 1, 2)\n"}