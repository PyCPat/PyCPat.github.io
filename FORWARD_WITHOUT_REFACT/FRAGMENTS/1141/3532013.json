{"BEFORE":"    def forward(self, x, with_logits=False):\n        h = self.encoder(x)\n        logits = self.fc(h)\n        log_probs = F.log_softmax(logits, dim=1)\n        if with_logits:\n            return log_probs, logits\n        return log_probs\n","AFTER":"    def forward(self, x: torch.Tensor) -> torch.Tensor:\n        return self.compute_log_probs_with_logits(x)[0]\n"}