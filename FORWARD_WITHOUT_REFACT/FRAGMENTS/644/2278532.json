{"BEFORE":"        assert X1.shape == X2.shape, 'Feature shape of two branches should be the same'\n","AFTER":"        X = self.preprocess(X)\n\n        X1 = self.features1(X)\n        X2 = self.features2(X)\n\n        N, _, H, W = X1.shape\n        N, _, H2, W2 = X2.shape\n\n        if (H != H2) or (W != W2):\n            X2 = F.interpolate(X2, (H, W), mode='bilinear', align_corners=True)\n\n        X1 = X1.view(N, 512, H*W)\n"}