{"BEFORE":"        x2 = self.context2(x2) #4\n        x3 = self.context3(x3) #8\n        x4 = self.context4(x4) #16\n        x5 = self.context5(x5) #32\n\n        f3, d3 = self.decoder(x3, x4, x5) #16\n\n        f3 = self.res(f3, (H \/\/ 4,  W \/\/ 4 ))\n        f2, p2  = self.attention2d(torch.cat([x2, f3], dim=1), d3.detach())\n        d2 = self.pyr.rec(d3.detach(), p2) #4\n\n        x1 = self.res(x1, (H \/\/ 2, W \/\/ 2))\n        f2 = self.res(f2, (H \/\/ 2, W \/\/ 2))\n        f1, _  = self.attention1d(torch.cat([x1, f2], dim=1), d2.detach()) #2\n        f1, p1 = self.attention1p(torch.cat([f1, f2], dim=1), p2.detach()) #2\n        d1 = self.pyr.rec(d2.detach(), p1) #2\n        \n        f1 = self.res(f1, (H, W))\n        f0, _ = self.attention0d(f1, d1.detach()) #2\n        _, p0 = self.attention0p(torch.cat([f0, f1], dim=1), p1.detach()) #2\n","AFTER":"        x = sample['image']\n        B, _, H, W = x.shape\n    \n        x0 = self.encoder(x)\n        x1, x2, x3, x4, x5 = self.backbone(x)\n        \n        x1 = self.context1(x1) #4\n        x2 = self.context2(x2) #4\n        x3 = self.context3(x3) #8\n        x4 = self.context4(x4) #16\n        x5 = self.context5(x5) #32\n\n        f3, d3 = self.decoder(x3, x4, x5) #16\n\n        f3 = self.res(f3, (H \/\/ 4,  W \/\/ 4 ))\n        f2, p2 = self.attention2(torch.cat([x2, f3.detach()], dim=1), d3.detach())\n        d2 = self.pyr.rec(d3.detach(), p2) #4\n\n        x1 = self.res(x1, (H \/\/ 2, W \/\/ 2))\n        f2 = self.res(f2, (H \/\/ 2, W \/\/ 2))\n        f1, p1 = self.attention1(torch.cat([x1, f2.detach()], dim=1), d2.detach(), p2.detach()) #2\n        d1 = self.pyr.rec(d2.detach(), p1) #2\n        \n        f1 = self.res(f1, (H, W))\n        _, p0 = self.attention0(torch.cat([x0, f1.detach()], dim=1), d1.detach(), p1.detach()) #2\n"}