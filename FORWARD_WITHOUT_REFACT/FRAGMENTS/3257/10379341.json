{"BEFORE":"        qkv = self.to_qkv(x).chunk(3, dim=2)\n","AFTER":"    def forward(self, x, context = None):\n        b, t, d, h = *x.shape, self.heads\n        assert divisible_by(t, self.buckets), f'sequence {t} needs to be divisible by bucket size {self.buckets}'\n        assert not (self.context_only and context is None), 'context key \/ values must be supplied if context self attention layer'\n\n        q = self.to_q(x)\n        kv = self.to_kv(x).chunk(2, dim=-1) if not self.context_only else (context, context)\n\n        qkv = (q, *kv)\n"}