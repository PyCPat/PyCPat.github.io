{"BEFORE":"        b = img.shape[0]\n        tokens = self.image_to_tokens(img)\n        print(tokens.shape)\n","AFTER":"        b, device = img.shape[0], img.device\n\n        tokens = self.image_to_tokens(img)\n        n = tokens.shape[1]\n\n        pos_embs = self.pos_emb(torch.arange(n, device = device))\n        bottom_level = tokens + rearrange(pos_embs, 'n d -> () n d')\n        levels = repeat(self.init_levels, 'l d -> b n l d', b = b, n = n)\n"}